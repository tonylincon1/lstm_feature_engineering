{"cells":[{"cell_type":"markdown","metadata":{"id":"S1SjD-NU1pmB"},"source":["# Preparações"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10717,"status":"ok","timestamp":1655860361369,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"9srDpcwJk3ob","outputId":"90829328-4c8f-43a2-bc7e-9c030c56a1ec"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting catboost\n","  Downloading catboost-1.0.6-cp37-none-manylinux1_x86_64.whl (76.6 MB)\n","\u001b[K     |████████████████████████████████| 76.6 MB 1.1 MB/s \n","\u001b[?25hRequirement already satisfied: pandas>=0.24.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.3.5)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.7/dist-packages (from catboost) (0.10.1)\n","Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.21.6)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from catboost) (1.15.0)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from catboost) (1.4.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from catboost) (3.2.2)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from catboost) (5.5.0)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2022.1)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2.8.2)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (0.11.0)\n","Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (3.0.9)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (1.4.3)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver>=1.0.1->matplotlib->catboost) (4.1.1)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.7/dist-packages (from plotly->catboost) (8.0.1)\n","Installing collected packages: catboost\n","Successfully installed catboost-1.0.6\n"]}],"source":["!pip install catboost"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":3768,"status":"ok","timestamp":1655860365117,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"TA9o4Sc6Qc6I","outputId":"8f4856e8-9b6d-4343-806f-acb0f3b5fcb9"},"outputs":[{"output_type":"display_data","data":{"text/html":["        <script type=\"text/javascript\">\n","        window.PlotlyConfig = {MathJaxConfig: 'local'};\n","        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n","        if (typeof require !== 'undefined') {\n","        require.undef(\"plotly\");\n","        requirejs.config({\n","            paths: {\n","                'plotly': ['https://cdn.plot.ly/plotly-2.8.3.min']\n","            }\n","        });\n","        require(['plotly'], function(Plotly) {\n","            window._Plotly = Plotly;\n","        });\n","        }\n","        </script>\n","        "]},"metadata":{}}],"source":["%matplotlib inline\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import pandas_profiling\n","import cufflinks as cf\n","import plotly.offline\n","from sklearn.model_selection import train_test_split\n","from catboost import CatBoostClassifier\n","from sklearn.ensemble import VotingClassifier\n","import lightgbm as lgb\n","cf.go_offline()\n","cf.set_config_file(offline=False, world_readable=True)\n","pd.set_option('display.max_columns', 38)"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22241,"status":"ok","timestamp":1655860387335,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"pbmv4QPG2mlV","outputId":"513afa52-734f-404c-d0ff-9d3950a51140"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"EzuQlWAIdlLY"},"source":["# Preparação"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"SmglVpXXQx7w","executionInfo":{"status":"ok","timestamp":1655860388719,"user_tz":180,"elapsed":1393,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"outputs":[],"source":["train_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/train_values.csv\", index_col='building_id')"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"-owqop2mQ46i","executionInfo":{"status":"ok","timestamp":1655860389177,"user_tz":180,"elapsed":465,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"outputs":[],"source":["train_labels = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/train_labels.csv\", index_col='building_id')"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"ySZDbujXdFdB","executionInfo":{"status":"ok","timestamp":1655860389491,"user_tz":180,"elapsed":318,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"outputs":[],"source":["test_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/test_values.csv\", index_col='building_id')"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":492,"status":"ok","timestamp":1655860389978,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"71GSlzD9Q7cY","outputId":"1dabde2a-7c03-4071-8b1d-eb91070eba39"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["             geo_level_1_id  geo_level_2_id  geo_level_3_id  \\\n","building_id                                                   \n","802906                    6             487           12198   \n","28830                     8             900            2812   \n","94947                    21             363            8973   \n","590882                   22             418           10694   \n","201944                   11             131            1488   \n","\n","             count_floors_pre_eq  age  area_percentage  height_percentage  \\\n","building_id                                                                 \n","802906                         2   30                6                  5   \n","28830                          2   10                8                  7   \n","94947                          2   10                5                  5   \n","590882                         2   10                6                  5   \n","201944                         3   30                8                  9   \n","\n","            land_surface_condition foundation_type roof_type  \\\n","building_id                                                    \n","802906                           t               r         n   \n","28830                            o               r         n   \n","94947                            t               r         n   \n","590882                           t               r         n   \n","201944                           t               r         n   \n","\n","            ground_floor_type other_floor_type position plan_configuration  \\\n","building_id                                                                  \n","802906                      f                q        t                  d   \n","28830                       x                q        s                  d   \n","94947                       f                x        t                  d   \n","590882                      f                x        s                  d   \n","201944                      f                x        s                  d   \n","\n","             has_superstructure_adobe_mud  \\\n","building_id                                 \n","802906                                  1   \n","28830                                   0   \n","94947                                   0   \n","590882                                  0   \n","201944                                  1   \n","\n","             has_superstructure_mud_mortar_stone  \\\n","building_id                                        \n","802906                                         1   \n","28830                                          1   \n","94947                                          1   \n","590882                                         1   \n","201944                                         0   \n","\n","             has_superstructure_stone_flag  \\\n","building_id                                  \n","802906                                   0   \n","28830                                    0   \n","94947                                    0   \n","590882                                   0   \n","201944                                   0   \n","\n","             has_superstructure_cement_mortar_stone  \\\n","building_id                                           \n","802906                                            0   \n","28830                                             0   \n","94947                                             0   \n","590882                                            0   \n","201944                                            0   \n","\n","             has_superstructure_mud_mortar_brick  \\\n","building_id                                        \n","802906                                         0   \n","28830                                          0   \n","94947                                          0   \n","590882                                         0   \n","201944                                         0   \n","\n","             has_superstructure_cement_mortar_brick  \\\n","building_id                                           \n","802906                                            0   \n","28830                                             0   \n","94947                                             0   \n","590882                                            0   \n","201944                                            0   \n","\n","             has_superstructure_timber  has_superstructure_bamboo  \\\n","building_id                                                         \n","802906                               0                          0   \n","28830                                0                          0   \n","94947                                0                          0   \n","590882                               1                          1   \n","201944                               0                          0   \n","\n","             has_superstructure_rc_non_engineered  \\\n","building_id                                         \n","802906                                          0   \n","28830                                           0   \n","94947                                           0   \n","590882                                          0   \n","201944                                          0   \n","\n","             has_superstructure_rc_engineered  has_superstructure_other  \\\n","building_id                                                               \n","802906                                      0                         0   \n","28830                                       0                         0   \n","94947                                       0                         0   \n","590882                                      0                         0   \n","201944                                      0                         0   \n","\n","            legal_ownership_status  count_families  has_secondary_use  \\\n","building_id                                                             \n","802906                           v               1                  0   \n","28830                            v               1                  0   \n","94947                            v               1                  0   \n","590882                           v               1                  0   \n","201944                           v               1                  0   \n","\n","             has_secondary_use_agriculture  has_secondary_use_hotel  \\\n","building_id                                                           \n","802906                                   0                        0   \n","28830                                    0                        0   \n","94947                                    0                        0   \n","590882                                   0                        0   \n","201944                                   0                        0   \n","\n","             has_secondary_use_rental  has_secondary_use_institution  \\\n","building_id                                                            \n","802906                              0                              0   \n","28830                               0                              0   \n","94947                               0                              0   \n","590882                              0                              0   \n","201944                              0                              0   \n","\n","             has_secondary_use_school  has_secondary_use_industry  \\\n","building_id                                                         \n","802906                              0                           0   \n","28830                               0                           0   \n","94947                               0                           0   \n","590882                              0                           0   \n","201944                              0                           0   \n","\n","             has_secondary_use_health_post  has_secondary_use_gov_office  \\\n","building_id                                                                \n","802906                                   0                             0   \n","28830                                    0                             0   \n","94947                                    0                             0   \n","590882                                   0                             0   \n","201944                                   0                             0   \n","\n","             has_secondary_use_use_police  has_secondary_use_other  \n","building_id                                                         \n","802906                                  0                        0  \n","28830                                   0                        0  \n","94947                                   0                        0  \n","590882                                  0                        0  \n","201944                                  0                        0  "],"text/html":["\n","  <div id=\"df-5afe46ad-428b-429c-bc1f-ec178f3528af\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>geo_level_1_id</th>\n","      <th>geo_level_2_id</th>\n","      <th>geo_level_3_id</th>\n","      <th>count_floors_pre_eq</th>\n","      <th>age</th>\n","      <th>area_percentage</th>\n","      <th>height_percentage</th>\n","      <th>land_surface_condition</th>\n","      <th>foundation_type</th>\n","      <th>roof_type</th>\n","      <th>ground_floor_type</th>\n","      <th>other_floor_type</th>\n","      <th>position</th>\n","      <th>plan_configuration</th>\n","      <th>has_superstructure_adobe_mud</th>\n","      <th>has_superstructure_mud_mortar_stone</th>\n","      <th>has_superstructure_stone_flag</th>\n","      <th>has_superstructure_cement_mortar_stone</th>\n","      <th>has_superstructure_mud_mortar_brick</th>\n","      <th>has_superstructure_cement_mortar_brick</th>\n","      <th>has_superstructure_timber</th>\n","      <th>has_superstructure_bamboo</th>\n","      <th>has_superstructure_rc_non_engineered</th>\n","      <th>has_superstructure_rc_engineered</th>\n","      <th>has_superstructure_other</th>\n","      <th>legal_ownership_status</th>\n","      <th>count_families</th>\n","      <th>has_secondary_use</th>\n","      <th>has_secondary_use_agriculture</th>\n","      <th>has_secondary_use_hotel</th>\n","      <th>has_secondary_use_rental</th>\n","      <th>has_secondary_use_institution</th>\n","      <th>has_secondary_use_school</th>\n","      <th>has_secondary_use_industry</th>\n","      <th>has_secondary_use_health_post</th>\n","      <th>has_secondary_use_gov_office</th>\n","      <th>has_secondary_use_use_police</th>\n","      <th>has_secondary_use_other</th>\n","    </tr>\n","    <tr>\n","      <th>building_id</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>802906</th>\n","      <td>6</td>\n","      <td>487</td>\n","      <td>12198</td>\n","      <td>2</td>\n","      <td>30</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>q</td>\n","      <td>t</td>\n","      <td>d</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>28830</th>\n","      <td>8</td>\n","      <td>900</td>\n","      <td>2812</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>o</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>x</td>\n","      <td>q</td>\n","      <td>s</td>\n","      <td>d</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>94947</th>\n","      <td>21</td>\n","      <td>363</td>\n","      <td>8973</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>x</td>\n","      <td>t</td>\n","      <td>d</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>590882</th>\n","      <td>22</td>\n","      <td>418</td>\n","      <td>10694</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>x</td>\n","      <td>s</td>\n","      <td>d</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>201944</th>\n","      <td>11</td>\n","      <td>131</td>\n","      <td>1488</td>\n","      <td>3</td>\n","      <td>30</td>\n","      <td>8</td>\n","      <td>9</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>n</td>\n","      <td>f</td>\n","      <td>x</td>\n","      <td>s</td>\n","      <td>d</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>v</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5afe46ad-428b-429c-bc1f-ec178f3528af')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5afe46ad-428b-429c-bc1f-ec178f3528af button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5afe46ad-428b-429c-bc1f-ec178f3528af');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}],"source":["train_values.head()"]},{"cell_type":"markdown","metadata":{"id":"nFc4bb3ZoehJ"},"source":["# Ensemble Model CatBoost e LightGBM"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":34,"status":"ok","timestamp":1655860389979,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"2KbROcRgLm0K","outputId":"e20446bd-27b6-40e5-8dda-4ffb6cc556fa"},"outputs":[{"output_type":"stream","name":"stdout","text":["Wed Jun 22 01:16:06 2022       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla P100-PCIE...  Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   40C    P0    27W / 250W |      0MiB / 16280MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"]},{"cell_type":"code","source":["from sklearn.metrics import f1_score\n","\n","print(\"Resample the train test split & try these parameters set\")\n","X = train_values; y = train_labels\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20)\n","\n","dummies1 = pd.get_dummies(X_train[[\"land_surface_condition\", \"foundation_type\", \"roof_type\", \"ground_floor_type\", \"other_floor_type\", \"position\", \"plan_configuration\", \"legal_ownership_status\"]])\n","dummies2 = pd.get_dummies(X_test[[\"land_surface_condition\", \"foundation_type\", \"roof_type\", \"ground_floor_type\", \"other_floor_type\", \"position\", \"plan_configuration\", \"legal_ownership_status\"]])\n","\n","X_train = X_train.drop([\"land_surface_condition\", \"foundation_type\", \"roof_type\", \"ground_floor_type\", \"other_floor_type\", \"position\", \"plan_configuration\", \"legal_ownership_status\"], axis = 1)\n","X_test = X_test.drop([\"land_surface_condition\", \"foundation_type\", \"roof_type\", \"ground_floor_type\", \"other_floor_type\", \"position\", \"plan_configuration\", \"legal_ownership_status\"], axis = 1)\n","\n","X_train = pd.concat([X_train, dummies1], axis=1)\n","X_test = pd.concat([X_test, dummies2], axis=1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jHXAwPP2tJwA","executionInfo":{"status":"ok","timestamp":1655860390389,"user_tz":180,"elapsed":426,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"9f812d96-09ef-45a9-8798-756c3b7317eb"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["Resample the train test split & try these parameters set\n"]}]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20646,"status":"ok","timestamp":1655860411029,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"RmtUXnTumP5d","outputId":"7dd59a09-afe1-428c-d4ce-c7ae65e9e857"},"outputs":[{"output_type":"stream","name":"stdout","text":["Score on test set\n","\n"," ========================================================\n","0.7390495193875789\n","\n"," Benchmark model was: 0.5815\n"]}],"source":["modellgb = lgb.LGBMClassifier(colsample_bytree=0.7, max_depth=25, min_split_gain=0.3,\n","               num_leaves=200, random_seed=42, reg_alpha=1.3, reg_lambda=1.1,\n","               subsample=0.9, subsample_freq=20)\n","modellgb.fit(X_train, y_train.values.ravel())\n","predslgb=modellgb.predict(X_test)\n","\n","#f1 score is the metric used in the competition\n","accuracy1=f1_score(y_test,predslgb,average='micro')\n","print(\"Score on test set\")\n","print(\"\\n ========================================================\")\n","print(accuracy1)\n","print('\\n Benchmark model was: 0.5815')"]},{"cell_type":"code","source":["predslgb.shape "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aBveJ9Ll2MaF","executionInfo":{"status":"ok","timestamp":1655860411031,"user_tz":180,"elapsed":17,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"61a94049-8f38-4743-fae1-9699ba1be144"},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(52121,)"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["#input best params here from randm.best_params_\n","modelcat = CatBoostClassifier(eval_metric='TotalF1',random_seed=42, silent=True, task_type=\"GPU\",cat_features=list(X_train.columns), border_count=13, depth= 10, iterations = 5000, l2_leaf_reg = 3, learning_rate = 0.05)\n","modelcat.fit(X_train, y_train,verbose=10)\n","predscat=modelcat.predict(X_test,verbose=10)\n","\n","#f1 score is the metric used in the competition\n","accuracy1=f1_score(y_test,predscat,average='micro')\n","print(\"Score on test set\")\n","print(\"\\n ========================================================\")\n","print(accuracy1)\n","print('\\n Benchmark model was: 0.5815')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZigSAcZomxxQ","executionInfo":{"status":"ok","timestamp":1655860572573,"user_tz":180,"elapsed":161552,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"7d3e6ea1-4b25-4792-eb79-0051707bbade"},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["0:\tlearn: 0.6831311\ttotal: 17.4ms\tremaining: 1m 27s\n","10:\tlearn: 0.6864910\ttotal: 195ms\tremaining: 1m 28s\n","20:\tlearn: 0.6873526\ttotal: 351ms\tremaining: 1m 23s\n","30:\tlearn: 0.6886232\ttotal: 507ms\tremaining: 1m 21s\n","40:\tlearn: 0.6904085\ttotal: 666ms\tremaining: 1m 20s\n","50:\tlearn: 0.6908552\ttotal: 827ms\tremaining: 1m 20s\n","60:\tlearn: 0.6913422\ttotal: 1s\tremaining: 1m 21s\n","70:\tlearn: 0.6919925\ttotal: 1.18s\tremaining: 1m 22s\n","80:\tlearn: 0.6928302\ttotal: 1.36s\tremaining: 1m 22s\n","90:\tlearn: 0.6942292\ttotal: 1.52s\tremaining: 1m 22s\n","100:\tlearn: 0.6978553\ttotal: 1.7s\tremaining: 1m 22s\n","110:\tlearn: 0.7006271\ttotal: 1.87s\tremaining: 1m 22s\n","120:\tlearn: 0.7023151\ttotal: 2.03s\tremaining: 1m 22s\n","130:\tlearn: 0.7039637\ttotal: 2.21s\tremaining: 1m 22s\n","140:\tlearn: 0.7051292\ttotal: 2.39s\tremaining: 1m 22s\n","150:\tlearn: 0.7059469\ttotal: 2.57s\tremaining: 1m 22s\n","160:\tlearn: 0.7070961\ttotal: 2.74s\tremaining: 1m 22s\n","170:\tlearn: 0.7079567\ttotal: 2.9s\tremaining: 1m 21s\n","180:\tlearn: 0.7087564\ttotal: 3.08s\tremaining: 1m 21s\n","190:\tlearn: 0.7096272\ttotal: 3.25s\tremaining: 1m 21s\n","200:\tlearn: 0.7101002\ttotal: 3.41s\tremaining: 1m 21s\n","210:\tlearn: 0.7107188\ttotal: 3.57s\tremaining: 1m 21s\n","220:\tlearn: 0.7113593\ttotal: 3.73s\tremaining: 1m 20s\n","230:\tlearn: 0.7118788\ttotal: 3.92s\tremaining: 1m 20s\n","240:\tlearn: 0.7123999\ttotal: 4.1s\tremaining: 1m 20s\n","250:\tlearn: 0.7129301\ttotal: 4.26s\tremaining: 1m 20s\n","260:\tlearn: 0.7134919\ttotal: 4.43s\tremaining: 1m 20s\n","270:\tlearn: 0.7141004\ttotal: 4.61s\tremaining: 1m 20s\n","280:\tlearn: 0.7146233\ttotal: 4.77s\tremaining: 1m 20s\n","290:\tlearn: 0.7148083\ttotal: 4.94s\tremaining: 1m 19s\n","300:\tlearn: 0.7153735\ttotal: 5.11s\tremaining: 1m 19s\n","310:\tlearn: 0.7157637\ttotal: 5.27s\tremaining: 1m 19s\n","320:\tlearn: 0.7161411\ttotal: 5.43s\tremaining: 1m 19s\n","330:\tlearn: 0.7164356\ttotal: 5.61s\tremaining: 1m 19s\n","340:\tlearn: 0.7168880\ttotal: 5.78s\tremaining: 1m 18s\n","350:\tlearn: 0.7173146\ttotal: 5.95s\tremaining: 1m 18s\n","360:\tlearn: 0.7176136\ttotal: 6.11s\tremaining: 1m 18s\n","370:\tlearn: 0.7179560\ttotal: 6.28s\tremaining: 1m 18s\n","380:\tlearn: 0.7182209\ttotal: 6.46s\tremaining: 1m 18s\n","390:\tlearn: 0.7186825\ttotal: 6.64s\tremaining: 1m 18s\n","400:\tlearn: 0.7188004\ttotal: 6.8s\tremaining: 1m 18s\n","410:\tlearn: 0.7189820\ttotal: 6.98s\tremaining: 1m 17s\n","420:\tlearn: 0.7193258\ttotal: 7.15s\tremaining: 1m 17s\n","430:\tlearn: 0.7196769\ttotal: 7.32s\tremaining: 1m 17s\n","440:\tlearn: 0.7199519\ttotal: 7.49s\tremaining: 1m 17s\n","450:\tlearn: 0.7202187\ttotal: 7.66s\tremaining: 1m 17s\n","460:\tlearn: 0.7203395\ttotal: 7.84s\tremaining: 1m 17s\n","470:\tlearn: 0.7206617\ttotal: 8s\tremaining: 1m 16s\n","480:\tlearn: 0.7210313\ttotal: 8.17s\tremaining: 1m 16s\n","490:\tlearn: 0.7215486\ttotal: 8.35s\tremaining: 1m 16s\n","500:\tlearn: 0.7217981\ttotal: 8.52s\tremaining: 1m 16s\n","510:\tlearn: 0.7220347\ttotal: 8.68s\tremaining: 1m 16s\n","520:\tlearn: 0.7221697\ttotal: 8.85s\tremaining: 1m 16s\n","530:\tlearn: 0.7225791\ttotal: 9.03s\tremaining: 1m 15s\n","540:\tlearn: 0.7229294\ttotal: 9.2s\tremaining: 1m 15s\n","550:\tlearn: 0.7230885\ttotal: 9.37s\tremaining: 1m 15s\n","560:\tlearn: 0.7233860\ttotal: 9.53s\tremaining: 1m 15s\n","570:\tlearn: 0.7236174\ttotal: 9.7s\tremaining: 1m 15s\n","580:\tlearn: 0.7237098\ttotal: 9.87s\tremaining: 1m 15s\n","590:\tlearn: 0.7240213\ttotal: 10s\tremaining: 1m 14s\n","600:\tlearn: 0.7242710\ttotal: 10.2s\tremaining: 1m 14s\n","610:\tlearn: 0.7243445\ttotal: 10.4s\tremaining: 1m 14s\n","620:\tlearn: 0.7245838\ttotal: 10.5s\tremaining: 1m 14s\n","630:\tlearn: 0.7247560\ttotal: 10.7s\tremaining: 1m 14s\n","640:\tlearn: 0.7248062\ttotal: 10.9s\tremaining: 1m 14s\n","650:\tlearn: 0.7251870\ttotal: 11.1s\tremaining: 1m 13s\n","660:\tlearn: 0.7253785\ttotal: 11.2s\tremaining: 1m 13s\n","670:\tlearn: 0.7255845\ttotal: 11.4s\tremaining: 1m 13s\n","680:\tlearn: 0.7257546\ttotal: 11.6s\tremaining: 1m 13s\n","690:\tlearn: 0.7259932\ttotal: 11.8s\tremaining: 1m 13s\n","700:\tlearn: 0.7261192\ttotal: 11.9s\tremaining: 1m 13s\n","710:\tlearn: 0.7261718\ttotal: 12.1s\tremaining: 1m 13s\n","720:\tlearn: 0.7263393\ttotal: 12.3s\tremaining: 1m 12s\n","730:\tlearn: 0.7265208\ttotal: 12.4s\tremaining: 1m 12s\n","740:\tlearn: 0.7267326\ttotal: 12.6s\tremaining: 1m 12s\n","750:\tlearn: 0.7269540\ttotal: 12.8s\tremaining: 1m 12s\n","760:\tlearn: 0.7270523\ttotal: 13s\tremaining: 1m 12s\n","770:\tlearn: 0.7271236\ttotal: 13.1s\tremaining: 1m 12s\n","780:\tlearn: 0.7273938\ttotal: 13.3s\tremaining: 1m 11s\n","790:\tlearn: 0.7276095\ttotal: 13.5s\tremaining: 1m 11s\n","800:\tlearn: 0.7277579\ttotal: 13.7s\tremaining: 1m 11s\n","810:\tlearn: 0.7279480\ttotal: 13.8s\tremaining: 1m 11s\n","820:\tlearn: 0.7280963\ttotal: 14s\tremaining: 1m 11s\n","830:\tlearn: 0.7281096\ttotal: 14.2s\tremaining: 1m 11s\n","840:\tlearn: 0.7282561\ttotal: 14.3s\tremaining: 1m 10s\n","850:\tlearn: 0.7283157\ttotal: 14.5s\tremaining: 1m 10s\n","860:\tlearn: 0.7284210\ttotal: 14.7s\tremaining: 1m 10s\n","870:\tlearn: 0.7286586\ttotal: 14.9s\tremaining: 1m 10s\n","880:\tlearn: 0.7287480\ttotal: 15.1s\tremaining: 1m 10s\n","890:\tlearn: 0.7288790\ttotal: 15.2s\tremaining: 1m 10s\n","900:\tlearn: 0.7289618\ttotal: 15.4s\tremaining: 1m 9s\n","910:\tlearn: 0.7292974\ttotal: 15.6s\tremaining: 1m 9s\n","920:\tlearn: 0.7294643\ttotal: 15.7s\tremaining: 1m 9s\n","930:\tlearn: 0.7296218\ttotal: 15.9s\tremaining: 1m 9s\n","940:\tlearn: 0.7298465\ttotal: 16.1s\tremaining: 1m 9s\n","950:\tlearn: 0.7300325\ttotal: 16.2s\tremaining: 1m 9s\n","960:\tlearn: 0.7300830\ttotal: 16.4s\tremaining: 1m 9s\n","970:\tlearn: 0.7303074\ttotal: 16.6s\tremaining: 1m 8s\n","980:\tlearn: 0.7304988\ttotal: 16.8s\tremaining: 1m 8s\n","990:\tlearn: 0.7307144\ttotal: 16.9s\tremaining: 1m 8s\n","1000:\tlearn: 0.7309438\ttotal: 17.1s\tremaining: 1m 8s\n","1010:\tlearn: 0.7309838\ttotal: 17.3s\tremaining: 1m 8s\n","1020:\tlearn: 0.7310752\ttotal: 17.4s\tremaining: 1m 7s\n","1030:\tlearn: 0.7312538\ttotal: 17.6s\tremaining: 1m 7s\n","1040:\tlearn: 0.7313762\ttotal: 17.8s\tremaining: 1m 7s\n","1050:\tlearn: 0.7314465\ttotal: 18s\tremaining: 1m 7s\n","1060:\tlearn: 0.7315959\ttotal: 18.1s\tremaining: 1m 7s\n","1070:\tlearn: 0.7316511\ttotal: 18.3s\tremaining: 1m 7s\n","1080:\tlearn: 0.7318007\ttotal: 18.5s\tremaining: 1m 7s\n","1090:\tlearn: 0.7319795\ttotal: 18.7s\tremaining: 1m 6s\n","1100:\tlearn: 0.7320818\ttotal: 18.8s\tremaining: 1m 6s\n","1110:\tlearn: 0.7321482\ttotal: 19s\tremaining: 1m 6s\n","1120:\tlearn: 0.7323120\ttotal: 19.2s\tremaining: 1m 6s\n","1130:\tlearn: 0.7323322\ttotal: 19.3s\tremaining: 1m 6s\n","1140:\tlearn: 0.7326058\ttotal: 19.5s\tremaining: 1m 5s\n","1150:\tlearn: 0.7327259\ttotal: 19.7s\tremaining: 1m 5s\n","1160:\tlearn: 0.7328259\ttotal: 19.8s\tremaining: 1m 5s\n","1170:\tlearn: 0.7329713\ttotal: 20s\tremaining: 1m 5s\n","1180:\tlearn: 0.7330069\ttotal: 20.2s\tremaining: 1m 5s\n","1190:\tlearn: 0.7331037\ttotal: 20.4s\tremaining: 1m 5s\n","1200:\tlearn: 0.7332383\ttotal: 20.6s\tremaining: 1m 5s\n","1210:\tlearn: 0.7333369\ttotal: 20.7s\tremaining: 1m 4s\n","1220:\tlearn: 0.7335110\ttotal: 20.9s\tremaining: 1m 4s\n","1230:\tlearn: 0.7335764\ttotal: 21.1s\tremaining: 1m 4s\n","1240:\tlearn: 0.7336875\ttotal: 21.3s\tremaining: 1m 4s\n","1250:\tlearn: 0.7337951\ttotal: 21.4s\tremaining: 1m 4s\n","1260:\tlearn: 0.7339349\ttotal: 21.6s\tremaining: 1m 4s\n","1270:\tlearn: 0.7340152\ttotal: 21.8s\tremaining: 1m 3s\n","1280:\tlearn: 0.7341699\ttotal: 21.9s\tremaining: 1m 3s\n","1290:\tlearn: 0.7343110\ttotal: 22.1s\tremaining: 1m 3s\n","1300:\tlearn: 0.7344621\ttotal: 22.3s\tremaining: 1m 3s\n","1310:\tlearn: 0.7345055\ttotal: 22.5s\tremaining: 1m 3s\n","1320:\tlearn: 0.7347191\ttotal: 22.6s\tremaining: 1m 3s\n","1330:\tlearn: 0.7346750\ttotal: 22.8s\tremaining: 1m 2s\n","1340:\tlearn: 0.7348108\ttotal: 23s\tremaining: 1m 2s\n","1350:\tlearn: 0.7348703\ttotal: 23.2s\tremaining: 1m 2s\n","1360:\tlearn: 0.7350018\ttotal: 23.3s\tremaining: 1m 2s\n","1370:\tlearn: 0.7351482\ttotal: 23.5s\tremaining: 1m 2s\n","1380:\tlearn: 0.7353109\ttotal: 23.7s\tremaining: 1m 2s\n","1390:\tlearn: 0.7354432\ttotal: 23.8s\tremaining: 1m 1s\n","1400:\tlearn: 0.7355202\ttotal: 24s\tremaining: 1m 1s\n","1410:\tlearn: 0.7357028\ttotal: 24.2s\tremaining: 1m 1s\n","1420:\tlearn: 0.7357711\ttotal: 24.3s\tremaining: 1m 1s\n","1430:\tlearn: 0.7359288\ttotal: 24.5s\tremaining: 1m 1s\n","1440:\tlearn: 0.7361303\ttotal: 24.7s\tremaining: 1m 1s\n","1450:\tlearn: 0.7362752\ttotal: 24.9s\tremaining: 1m\n","1460:\tlearn: 0.7363110\ttotal: 25.1s\tremaining: 1m\n","1470:\tlearn: 0.7365077\ttotal: 25.2s\tremaining: 1m\n","1480:\tlearn: 0.7366148\ttotal: 25.4s\tremaining: 1m\n","1490:\tlearn: 0.7366831\ttotal: 25.6s\tremaining: 1m\n","1500:\tlearn: 0.7367552\ttotal: 25.7s\tremaining: 1m\n","1510:\tlearn: 0.7368458\ttotal: 25.9s\tremaining: 59.9s\n","1520:\tlearn: 0.7369888\ttotal: 26.1s\tremaining: 59.7s\n","1530:\tlearn: 0.7370034\ttotal: 26.3s\tremaining: 59.6s\n","1540:\tlearn: 0.7371361\ttotal: 26.4s\tremaining: 59.4s\n","1550:\tlearn: 0.7373113\ttotal: 26.6s\tremaining: 59.2s\n","1560:\tlearn: 0.7374000\ttotal: 26.8s\tremaining: 59s\n","1570:\tlearn: 0.7375814\ttotal: 27s\tremaining: 58.9s\n","1580:\tlearn: 0.7377132\ttotal: 27.2s\tremaining: 58.7s\n","1590:\tlearn: 0.7377372\ttotal: 27.3s\tremaining: 58.6s\n","1600:\tlearn: 0.7378380\ttotal: 27.5s\tremaining: 58.4s\n","1610:\tlearn: 0.7379499\ttotal: 27.7s\tremaining: 58.2s\n","1620:\tlearn: 0.7380985\ttotal: 27.8s\tremaining: 58s\n","1630:\tlearn: 0.7381628\ttotal: 28s\tremaining: 57.9s\n","1640:\tlearn: 0.7382808\ttotal: 28.2s\tremaining: 57.7s\n","1650:\tlearn: 0.7384733\ttotal: 28.3s\tremaining: 57.5s\n","1660:\tlearn: 0.7385634\ttotal: 28.5s\tremaining: 57.3s\n","1670:\tlearn: 0.7386511\ttotal: 28.7s\tremaining: 57.2s\n","1680:\tlearn: 0.7387858\ttotal: 28.9s\tremaining: 57s\n","1690:\tlearn: 0.7387693\ttotal: 29s\tremaining: 56.8s\n","1700:\tlearn: 0.7389069\ttotal: 29.2s\tremaining: 56.7s\n","1710:\tlearn: 0.7389793\ttotal: 29.4s\tremaining: 56.5s\n","1720:\tlearn: 0.7390380\ttotal: 29.6s\tremaining: 56.3s\n","1730:\tlearn: 0.7391509\ttotal: 29.7s\tremaining: 56.1s\n","1740:\tlearn: 0.7391488\ttotal: 29.9s\tremaining: 56s\n","1750:\tlearn: 0.7393496\ttotal: 30.1s\tremaining: 55.8s\n","1760:\tlearn: 0.7394535\ttotal: 30.3s\tremaining: 55.7s\n","1770:\tlearn: 0.7395317\ttotal: 30.4s\tremaining: 55.5s\n","1780:\tlearn: 0.7396507\ttotal: 30.6s\tremaining: 55.3s\n","1790:\tlearn: 0.7397608\ttotal: 30.8s\tremaining: 55.1s\n","1800:\tlearn: 0.7397979\ttotal: 30.9s\tremaining: 55s\n","1810:\tlearn: 0.7398864\ttotal: 31.1s\tremaining: 54.8s\n","1820:\tlearn: 0.7400373\ttotal: 31.3s\tremaining: 54.6s\n","1830:\tlearn: 0.7401584\ttotal: 31.5s\tremaining: 54.5s\n","1840:\tlearn: 0.7402917\ttotal: 31.6s\tremaining: 54.3s\n","1850:\tlearn: 0.7402499\ttotal: 31.8s\tremaining: 54.2s\n","1860:\tlearn: 0.7404008\ttotal: 32s\tremaining: 54s\n","1870:\tlearn: 0.7404994\ttotal: 32.2s\tremaining: 53.8s\n","1880:\tlearn: 0.7406402\ttotal: 32.4s\tremaining: 53.7s\n","1890:\tlearn: 0.7407562\ttotal: 32.5s\tremaining: 53.5s\n","1900:\tlearn: 0.7407999\ttotal: 32.7s\tremaining: 53.3s\n","1910:\tlearn: 0.7408453\ttotal: 32.9s\tremaining: 53.2s\n","1920:\tlearn: 0.7410564\ttotal: 33.1s\tremaining: 53s\n","1930:\tlearn: 0.7410570\ttotal: 33.2s\tremaining: 52.8s\n","1940:\tlearn: 0.7411309\ttotal: 33.4s\tremaining: 52.6s\n","1950:\tlearn: 0.7411826\ttotal: 33.6s\tremaining: 52.4s\n","1960:\tlearn: 0.7413185\ttotal: 33.7s\tremaining: 52.3s\n","1970:\tlearn: 0.7413643\ttotal: 33.9s\tremaining: 52.1s\n","1980:\tlearn: 0.7414600\ttotal: 34.1s\tremaining: 51.9s\n","1990:\tlearn: 0.7415162\ttotal: 34.2s\tremaining: 51.8s\n","2000:\tlearn: 0.7415502\ttotal: 34.4s\tremaining: 51.6s\n","2010:\tlearn: 0.7416647\ttotal: 34.6s\tremaining: 51.4s\n","2020:\tlearn: 0.7417266\ttotal: 34.8s\tremaining: 51.3s\n","2030:\tlearn: 0.7418220\ttotal: 34.9s\tremaining: 51.1s\n","2040:\tlearn: 0.7419558\ttotal: 35.1s\tremaining: 50.9s\n","2050:\tlearn: 0.7420719\ttotal: 35.3s\tremaining: 50.8s\n","2060:\tlearn: 0.7422382\ttotal: 35.5s\tremaining: 50.6s\n","2070:\tlearn: 0.7422258\ttotal: 35.6s\tremaining: 50.4s\n","2080:\tlearn: 0.7422507\ttotal: 35.8s\tremaining: 50.2s\n","2090:\tlearn: 0.7424088\ttotal: 36s\tremaining: 50.1s\n","2100:\tlearn: 0.7424848\ttotal: 36.2s\tremaining: 49.9s\n","2110:\tlearn: 0.7426087\ttotal: 36.4s\tremaining: 49.8s\n","2120:\tlearn: 0.7427109\ttotal: 36.5s\tremaining: 49.6s\n","2130:\tlearn: 0.7427179\ttotal: 36.7s\tremaining: 49.4s\n","2140:\tlearn: 0.7427886\ttotal: 36.9s\tremaining: 49.2s\n","2150:\tlearn: 0.7429729\ttotal: 37s\tremaining: 49.1s\n","2160:\tlearn: 0.7429590\ttotal: 37.2s\tremaining: 48.9s\n","2170:\tlearn: 0.7431098\ttotal: 37.4s\tremaining: 48.7s\n","2180:\tlearn: 0.7432249\ttotal: 37.6s\tremaining: 48.6s\n","2190:\tlearn: 0.7432484\ttotal: 37.7s\tremaining: 48.4s\n","2200:\tlearn: 0.7433223\ttotal: 37.9s\tremaining: 48.2s\n","2210:\tlearn: 0.7434196\ttotal: 38.1s\tremaining: 48s\n","2220:\tlearn: 0.7434691\ttotal: 38.3s\tremaining: 47.9s\n","2230:\tlearn: 0.7435696\ttotal: 38.4s\tremaining: 47.7s\n","2240:\tlearn: 0.7436021\ttotal: 38.6s\tremaining: 47.5s\n","2250:\tlearn: 0.7437114\ttotal: 38.8s\tremaining: 47.4s\n","2260:\tlearn: 0.7437781\ttotal: 39s\tremaining: 47.2s\n","2270:\tlearn: 0.7438623\ttotal: 39.1s\tremaining: 47s\n","2280:\tlearn: 0.7439509\ttotal: 39.3s\tremaining: 46.8s\n","2290:\tlearn: 0.7440777\ttotal: 39.5s\tremaining: 46.7s\n","2300:\tlearn: 0.7441258\ttotal: 39.6s\tremaining: 46.5s\n","2310:\tlearn: 0.7442171\ttotal: 39.8s\tremaining: 46.3s\n","2320:\tlearn: 0.7442832\ttotal: 40s\tremaining: 46.2s\n","2330:\tlearn: 0.7444329\ttotal: 40.2s\tremaining: 46s\n","2340:\tlearn: 0.7444097\ttotal: 40.3s\tremaining: 45.8s\n","2350:\tlearn: 0.7445236\ttotal: 40.5s\tremaining: 45.7s\n","2360:\tlearn: 0.7445583\ttotal: 40.7s\tremaining: 45.5s\n","2370:\tlearn: 0.7446973\ttotal: 40.9s\tremaining: 45.3s\n","2380:\tlearn: 0.7447782\ttotal: 41s\tremaining: 45.2s\n","2390:\tlearn: 0.7447814\ttotal: 41.2s\tremaining: 45s\n","2400:\tlearn: 0.7448725\ttotal: 41.4s\tremaining: 44.8s\n","2410:\tlearn: 0.7450213\ttotal: 41.6s\tremaining: 44.6s\n","2420:\tlearn: 0.7450520\ttotal: 41.7s\tremaining: 44.5s\n","2430:\tlearn: 0.7451499\ttotal: 41.9s\tremaining: 44.3s\n","2440:\tlearn: 0.7451782\ttotal: 42.1s\tremaining: 44.1s\n","2450:\tlearn: 0.7452633\ttotal: 42.2s\tremaining: 43.9s\n","2460:\tlearn: 0.7453497\ttotal: 42.4s\tremaining: 43.8s\n","2470:\tlearn: 0.7454500\ttotal: 42.6s\tremaining: 43.6s\n","2480:\tlearn: 0.7455377\ttotal: 42.8s\tremaining: 43.4s\n","2490:\tlearn: 0.7457065\ttotal: 43s\tremaining: 43.3s\n","2500:\tlearn: 0.7457787\ttotal: 43.1s\tremaining: 43.1s\n","2510:\tlearn: 0.7458707\ttotal: 43.3s\tremaining: 42.9s\n","2520:\tlearn: 0.7459555\ttotal: 43.5s\tremaining: 42.8s\n","2530:\tlearn: 0.7460054\ttotal: 43.7s\tremaining: 42.6s\n","2540:\tlearn: 0.7461613\ttotal: 43.8s\tremaining: 42.4s\n","2550:\tlearn: 0.7462313\ttotal: 44s\tremaining: 42.3s\n","2560:\tlearn: 0.7462961\ttotal: 44.2s\tremaining: 42.1s\n","2570:\tlearn: 0.7463680\ttotal: 44.4s\tremaining: 41.9s\n","2580:\tlearn: 0.7465019\ttotal: 44.5s\tremaining: 41.7s\n","2590:\tlearn: 0.7466099\ttotal: 44.7s\tremaining: 41.6s\n","2600:\tlearn: 0.7467503\ttotal: 44.9s\tremaining: 41.4s\n","2610:\tlearn: 0.7467347\ttotal: 45.1s\tremaining: 41.2s\n","2620:\tlearn: 0.7468756\ttotal: 45.2s\tremaining: 41.1s\n","2630:\tlearn: 0.7469750\ttotal: 45.4s\tremaining: 40.9s\n","2640:\tlearn: 0.7470918\ttotal: 45.6s\tremaining: 40.7s\n","2650:\tlearn: 0.7472120\ttotal: 45.8s\tremaining: 40.5s\n","2660:\tlearn: 0.7473362\ttotal: 45.9s\tremaining: 40.4s\n","2670:\tlearn: 0.7474191\ttotal: 46.1s\tremaining: 40.2s\n","2680:\tlearn: 0.7475089\ttotal: 46.3s\tremaining: 40s\n","2690:\tlearn: 0.7476387\ttotal: 46.5s\tremaining: 39.9s\n","2700:\tlearn: 0.7477463\ttotal: 46.6s\tremaining: 39.7s\n","2710:\tlearn: 0.7477593\ttotal: 46.8s\tremaining: 39.5s\n","2720:\tlearn: 0.7478251\ttotal: 47s\tremaining: 39.4s\n","2730:\tlearn: 0.7479465\ttotal: 47.2s\tremaining: 39.2s\n","2740:\tlearn: 0.7480169\ttotal: 47.4s\tremaining: 39s\n","2750:\tlearn: 0.7480814\ttotal: 47.5s\tremaining: 38.9s\n","2760:\tlearn: 0.7482712\ttotal: 47.7s\tremaining: 38.7s\n","2770:\tlearn: 0.7482991\ttotal: 47.9s\tremaining: 38.5s\n","2780:\tlearn: 0.7484132\ttotal: 48s\tremaining: 38.3s\n","2790:\tlearn: 0.7485258\ttotal: 48.2s\tremaining: 38.2s\n","2800:\tlearn: 0.7485933\ttotal: 48.4s\tremaining: 38s\n","2810:\tlearn: 0.7487795\ttotal: 48.6s\tremaining: 37.8s\n","2820:\tlearn: 0.7488526\ttotal: 48.7s\tremaining: 37.6s\n","2830:\tlearn: 0.7489388\ttotal: 48.9s\tremaining: 37.5s\n","2840:\tlearn: 0.7490511\ttotal: 49.1s\tremaining: 37.3s\n","2850:\tlearn: 0.7491029\ttotal: 49.2s\tremaining: 37.1s\n","2860:\tlearn: 0.7491756\ttotal: 49.4s\tremaining: 37s\n","2870:\tlearn: 0.7492163\ttotal: 49.6s\tremaining: 36.8s\n","2880:\tlearn: 0.7492539\ttotal: 49.8s\tremaining: 36.6s\n","2890:\tlearn: 0.7492898\ttotal: 50s\tremaining: 36.5s\n","2900:\tlearn: 0.7494358\ttotal: 50.2s\tremaining: 36.3s\n","2910:\tlearn: 0.7495372\ttotal: 50.3s\tremaining: 36.1s\n","2920:\tlearn: 0.7495323\ttotal: 50.5s\tremaining: 36s\n","2930:\tlearn: 0.7496529\ttotal: 50.7s\tremaining: 35.8s\n","2940:\tlearn: 0.7496824\ttotal: 50.8s\tremaining: 35.6s\n","2950:\tlearn: 0.7497054\ttotal: 51s\tremaining: 35.4s\n","2960:\tlearn: 0.7497902\ttotal: 51.2s\tremaining: 35.3s\n","2970:\tlearn: 0.7499567\ttotal: 51.4s\tremaining: 35.1s\n","2980:\tlearn: 0.7500499\ttotal: 51.6s\tremaining: 34.9s\n","2990:\tlearn: 0.7501619\ttotal: 51.7s\tremaining: 34.7s\n","3000:\tlearn: 0.7502521\ttotal: 51.9s\tremaining: 34.6s\n","3010:\tlearn: 0.7503430\ttotal: 52.1s\tremaining: 34.4s\n","3020:\tlearn: 0.7504378\ttotal: 52.2s\tremaining: 34.2s\n","3030:\tlearn: 0.7505345\ttotal: 52.4s\tremaining: 34.1s\n","3040:\tlearn: 0.7505776\ttotal: 52.6s\tremaining: 33.9s\n","3050:\tlearn: 0.7506359\ttotal: 52.8s\tremaining: 33.7s\n","3060:\tlearn: 0.7506982\ttotal: 53s\tremaining: 33.6s\n","3070:\tlearn: 0.7508630\ttotal: 53.1s\tremaining: 33.4s\n","3080:\tlearn: 0.7509887\ttotal: 53.3s\tremaining: 33.2s\n","3090:\tlearn: 0.7510787\ttotal: 53.5s\tremaining: 33s\n","3100:\tlearn: 0.7511943\ttotal: 53.7s\tremaining: 32.9s\n","3110:\tlearn: 0.7512669\ttotal: 53.8s\tremaining: 32.7s\n","3120:\tlearn: 0.7513092\ttotal: 54s\tremaining: 32.5s\n","3130:\tlearn: 0.7514300\ttotal: 54.2s\tremaining: 32.4s\n","3140:\tlearn: 0.7514694\ttotal: 54.4s\tremaining: 32.2s\n","3150:\tlearn: 0.7515115\ttotal: 54.6s\tremaining: 32s\n","3160:\tlearn: 0.7516642\ttotal: 54.8s\tremaining: 31.9s\n","3170:\tlearn: 0.7517176\ttotal: 54.9s\tremaining: 31.7s\n","3180:\tlearn: 0.7518893\ttotal: 55.1s\tremaining: 31.5s\n","3190:\tlearn: 0.7519737\ttotal: 55.3s\tremaining: 31.4s\n","3200:\tlearn: 0.7519993\ttotal: 55.5s\tremaining: 31.2s\n","3210:\tlearn: 0.7521796\ttotal: 55.7s\tremaining: 31s\n","3220:\tlearn: 0.7522010\ttotal: 55.8s\tremaining: 30.8s\n","3230:\tlearn: 0.7523520\ttotal: 56s\tremaining: 30.7s\n","3240:\tlearn: 0.7524232\ttotal: 56.2s\tremaining: 30.5s\n","3250:\tlearn: 0.7524564\ttotal: 56.4s\tremaining: 30.3s\n","3260:\tlearn: 0.7525389\ttotal: 56.6s\tremaining: 30.2s\n","3270:\tlearn: 0.7526687\ttotal: 56.8s\tremaining: 30s\n","3280:\tlearn: 0.7527519\ttotal: 57s\tremaining: 29.8s\n","3290:\tlearn: 0.7528311\ttotal: 57.1s\tremaining: 29.7s\n","3300:\tlearn: 0.7529059\ttotal: 57.3s\tremaining: 29.5s\n","3310:\tlearn: 0.7529777\ttotal: 57.5s\tremaining: 29.3s\n","3320:\tlearn: 0.7529978\ttotal: 57.7s\tremaining: 29.2s\n","3330:\tlearn: 0.7530293\ttotal: 57.8s\tremaining: 29s\n","3340:\tlearn: 0.7531904\ttotal: 58s\tremaining: 28.8s\n","3350:\tlearn: 0.7532974\ttotal: 58.2s\tremaining: 28.6s\n","3360:\tlearn: 0.7532713\ttotal: 58.4s\tremaining: 28.5s\n","3370:\tlearn: 0.7533432\ttotal: 58.5s\tremaining: 28.3s\n","3380:\tlearn: 0.7535505\ttotal: 58.7s\tremaining: 28.1s\n","3390:\tlearn: 0.7536176\ttotal: 58.9s\tremaining: 27.9s\n","3400:\tlearn: 0.7536471\ttotal: 59.1s\tremaining: 27.8s\n","3410:\tlearn: 0.7537845\ttotal: 59.2s\tremaining: 27.6s\n","3420:\tlearn: 0.7537877\ttotal: 59.4s\tremaining: 27.4s\n","3430:\tlearn: 0.7538753\ttotal: 59.6s\tremaining: 27.3s\n","3440:\tlearn: 0.7539485\ttotal: 59.8s\tremaining: 27.1s\n","3450:\tlearn: 0.7540692\ttotal: 59.9s\tremaining: 26.9s\n","3460:\tlearn: 0.7540815\ttotal: 1m\tremaining: 26.7s\n","3470:\tlearn: 0.7541893\ttotal: 1m\tremaining: 26.6s\n","3480:\tlearn: 0.7542447\ttotal: 1m\tremaining: 26.4s\n","3490:\tlearn: 0.7542659\ttotal: 1m\tremaining: 26.2s\n","3500:\tlearn: 0.7543996\ttotal: 1m\tremaining: 26s\n","3510:\tlearn: 0.7545128\ttotal: 1m\tremaining: 25.9s\n","3520:\tlearn: 0.7545647\ttotal: 1m 1s\tremaining: 25.7s\n","3530:\tlearn: 0.7546728\ttotal: 1m 1s\tremaining: 25.5s\n","3540:\tlearn: 0.7546914\ttotal: 1m 1s\tremaining: 25.4s\n","3550:\tlearn: 0.7548467\ttotal: 1m 1s\tremaining: 25.2s\n","3560:\tlearn: 0.7548757\ttotal: 1m 1s\tremaining: 25s\n","3570:\tlearn: 0.7550153\ttotal: 1m 2s\tremaining: 24.8s\n","3580:\tlearn: 0.7550813\ttotal: 1m 2s\tremaining: 24.7s\n","3590:\tlearn: 0.7551675\ttotal: 1m 2s\tremaining: 24.5s\n","3600:\tlearn: 0.7552197\ttotal: 1m 2s\tremaining: 24.3s\n","3610:\tlearn: 0.7553134\ttotal: 1m 2s\tremaining: 24.2s\n","3620:\tlearn: 0.7554500\ttotal: 1m 2s\tremaining: 24s\n","3630:\tlearn: 0.7555581\ttotal: 1m 3s\tremaining: 23.8s\n","3640:\tlearn: 0.7556342\ttotal: 1m 3s\tremaining: 23.6s\n","3650:\tlearn: 0.7556993\ttotal: 1m 3s\tremaining: 23.5s\n","3660:\tlearn: 0.7558404\ttotal: 1m 3s\tremaining: 23.3s\n","3670:\tlearn: 0.7559381\ttotal: 1m 3s\tremaining: 23.1s\n","3680:\tlearn: 0.7559132\ttotal: 1m 4s\tremaining: 22.9s\n","3690:\tlearn: 0.7559644\ttotal: 1m 4s\tremaining: 22.8s\n","3700:\tlearn: 0.7560614\ttotal: 1m 4s\tremaining: 22.6s\n","3710:\tlearn: 0.7561874\ttotal: 1m 4s\tremaining: 22.4s\n","3720:\tlearn: 0.7563243\ttotal: 1m 4s\tremaining: 22.3s\n","3730:\tlearn: 0.7564390\ttotal: 1m 4s\tremaining: 22.1s\n","3740:\tlearn: 0.7564892\ttotal: 1m 5s\tremaining: 21.9s\n","3750:\tlearn: 0.7564849\ttotal: 1m 5s\tremaining: 21.7s\n","3760:\tlearn: 0.7566089\ttotal: 1m 5s\tremaining: 21.6s\n","3770:\tlearn: 0.7566852\ttotal: 1m 5s\tremaining: 21.4s\n","3780:\tlearn: 0.7567688\ttotal: 1m 5s\tremaining: 21.2s\n","3790:\tlearn: 0.7569959\ttotal: 1m 6s\tremaining: 21.1s\n","3800:\tlearn: 0.7569476\ttotal: 1m 6s\tremaining: 20.9s\n","3810:\tlearn: 0.7570175\ttotal: 1m 6s\tremaining: 20.7s\n","3820:\tlearn: 0.7571504\ttotal: 1m 6s\tremaining: 20.5s\n","3830:\tlearn: 0.7572389\ttotal: 1m 6s\tremaining: 20.4s\n","3840:\tlearn: 0.7573354\ttotal: 1m 6s\tremaining: 20.2s\n","3850:\tlearn: 0.7573862\ttotal: 1m 7s\tremaining: 20s\n","3860:\tlearn: 0.7574967\ttotal: 1m 7s\tremaining: 19.8s\n","3870:\tlearn: 0.7575515\ttotal: 1m 7s\tremaining: 19.7s\n","3880:\tlearn: 0.7576319\ttotal: 1m 7s\tremaining: 19.5s\n","3890:\tlearn: 0.7577342\ttotal: 1m 7s\tremaining: 19.3s\n","3900:\tlearn: 0.7577929\ttotal: 1m 7s\tremaining: 19.1s\n","3910:\tlearn: 0.7578698\ttotal: 1m 8s\tremaining: 19s\n","3920:\tlearn: 0.7579383\ttotal: 1m 8s\tremaining: 18.8s\n","3930:\tlearn: 0.7579965\ttotal: 1m 8s\tremaining: 18.6s\n","3940:\tlearn: 0.7580902\ttotal: 1m 8s\tremaining: 18.5s\n","3950:\tlearn: 0.7581573\ttotal: 1m 8s\tremaining: 18.3s\n","3960:\tlearn: 0.7582785\ttotal: 1m 9s\tremaining: 18.1s\n","3970:\tlearn: 0.7582636\ttotal: 1m 9s\tremaining: 17.9s\n","3980:\tlearn: 0.7583676\ttotal: 1m 9s\tremaining: 17.8s\n","3990:\tlearn: 0.7584978\ttotal: 1m 9s\tremaining: 17.6s\n","4000:\tlearn: 0.7585653\ttotal: 1m 9s\tremaining: 17.4s\n","4010:\tlearn: 0.7585960\ttotal: 1m 9s\tremaining: 17.2s\n","4020:\tlearn: 0.7587312\ttotal: 1m 10s\tremaining: 17.1s\n","4030:\tlearn: 0.7588302\ttotal: 1m 10s\tremaining: 16.9s\n","4040:\tlearn: 0.7589447\ttotal: 1m 10s\tremaining: 16.7s\n","4050:\tlearn: 0.7590268\ttotal: 1m 10s\tremaining: 16.5s\n","4060:\tlearn: 0.7591548\ttotal: 1m 10s\tremaining: 16.4s\n","4070:\tlearn: 0.7592605\ttotal: 1m 10s\tremaining: 16.2s\n","4080:\tlearn: 0.7593170\ttotal: 1m 11s\tremaining: 16s\n","4090:\tlearn: 0.7595119\ttotal: 1m 11s\tremaining: 15.8s\n","4100:\tlearn: 0.7595348\ttotal: 1m 11s\tremaining: 15.7s\n","4110:\tlearn: 0.7595982\ttotal: 1m 11s\tremaining: 15.5s\n","4120:\tlearn: 0.7596289\ttotal: 1m 11s\tremaining: 15.3s\n","4130:\tlearn: 0.7596741\ttotal: 1m 12s\tremaining: 15.1s\n","4140:\tlearn: 0.7598795\ttotal: 1m 12s\tremaining: 15s\n","4150:\tlearn: 0.7600145\ttotal: 1m 12s\tremaining: 14.8s\n","4160:\tlearn: 0.7600162\ttotal: 1m 12s\tremaining: 14.6s\n","4170:\tlearn: 0.7601417\ttotal: 1m 12s\tremaining: 14.5s\n","4180:\tlearn: 0.7601836\ttotal: 1m 12s\tremaining: 14.3s\n","4190:\tlearn: 0.7602862\ttotal: 1m 13s\tremaining: 14.1s\n","4200:\tlearn: 0.7602957\ttotal: 1m 13s\tremaining: 13.9s\n","4210:\tlearn: 0.7603129\ttotal: 1m 13s\tremaining: 13.8s\n","4220:\tlearn: 0.7605294\ttotal: 1m 13s\tremaining: 13.6s\n","4230:\tlearn: 0.7605044\ttotal: 1m 13s\tremaining: 13.4s\n","4240:\tlearn: 0.7606048\ttotal: 1m 13s\tremaining: 13.2s\n","4250:\tlearn: 0.7606760\ttotal: 1m 14s\tremaining: 13.1s\n","4260:\tlearn: 0.7606828\ttotal: 1m 14s\tremaining: 12.9s\n","4270:\tlearn: 0.7608819\ttotal: 1m 14s\tremaining: 12.7s\n","4280:\tlearn: 0.7609456\ttotal: 1m 14s\tremaining: 12.6s\n","4290:\tlearn: 0.7609670\ttotal: 1m 14s\tremaining: 12.4s\n","4300:\tlearn: 0.7609939\ttotal: 1m 15s\tremaining: 12.2s\n","4310:\tlearn: 0.7610615\ttotal: 1m 15s\tremaining: 12s\n","4320:\tlearn: 0.7611337\ttotal: 1m 15s\tremaining: 11.9s\n","4330:\tlearn: 0.7613028\ttotal: 1m 15s\tremaining: 11.7s\n","4340:\tlearn: 0.7614013\ttotal: 1m 15s\tremaining: 11.5s\n","4350:\tlearn: 0.7614301\ttotal: 1m 16s\tremaining: 11.3s\n","4360:\tlearn: 0.7615144\ttotal: 1m 16s\tremaining: 11.2s\n","4370:\tlearn: 0.7615724\ttotal: 1m 16s\tremaining: 11s\n","4380:\tlearn: 0.7617307\ttotal: 1m 16s\tremaining: 10.8s\n","4390:\tlearn: 0.7618638\ttotal: 1m 16s\tremaining: 10.6s\n","4400:\tlearn: 0.7619112\ttotal: 1m 16s\tremaining: 10.5s\n","4410:\tlearn: 0.7620340\ttotal: 1m 17s\tremaining: 10.3s\n","4420:\tlearn: 0.7621194\ttotal: 1m 17s\tremaining: 10.1s\n","4430:\tlearn: 0.7622801\ttotal: 1m 17s\tremaining: 9.94s\n","4440:\tlearn: 0.7623858\ttotal: 1m 17s\tremaining: 9.77s\n","4450:\tlearn: 0.7624815\ttotal: 1m 17s\tremaining: 9.59s\n","4460:\tlearn: 0.7625040\ttotal: 1m 17s\tremaining: 9.42s\n","4470:\tlearn: 0.7625987\ttotal: 1m 18s\tremaining: 9.24s\n","4480:\tlearn: 0.7626596\ttotal: 1m 18s\tremaining: 9.07s\n","4490:\tlearn: 0.7626562\ttotal: 1m 18s\tremaining: 8.89s\n","4500:\tlearn: 0.7627114\ttotal: 1m 18s\tremaining: 8.72s\n","4510:\tlearn: 0.7628491\ttotal: 1m 18s\tremaining: 8.55s\n","4520:\tlearn: 0.7628924\ttotal: 1m 19s\tremaining: 8.37s\n","4530:\tlearn: 0.7629805\ttotal: 1m 19s\tremaining: 8.2s\n","4540:\tlearn: 0.7630238\ttotal: 1m 19s\tremaining: 8.02s\n","4550:\tlearn: 0.7630707\ttotal: 1m 19s\tremaining: 7.85s\n","4560:\tlearn: 0.7631354\ttotal: 1m 19s\tremaining: 7.67s\n","4570:\tlearn: 0.7632966\ttotal: 1m 19s\tremaining: 7.5s\n","4580:\tlearn: 0.7633854\ttotal: 1m 20s\tremaining: 7.32s\n","4590:\tlearn: 0.7634917\ttotal: 1m 20s\tremaining: 7.15s\n","4600:\tlearn: 0.7635556\ttotal: 1m 20s\tremaining: 6.97s\n","4610:\tlearn: 0.7636100\ttotal: 1m 20s\tremaining: 6.8s\n","4620:\tlearn: 0.7637831\ttotal: 1m 20s\tremaining: 6.63s\n","4630:\tlearn: 0.7637865\ttotal: 1m 20s\tremaining: 6.45s\n","4640:\tlearn: 0.7638107\ttotal: 1m 21s\tremaining: 6.28s\n","4650:\tlearn: 0.7638681\ttotal: 1m 21s\tremaining: 6.1s\n","4660:\tlearn: 0.7638903\ttotal: 1m 21s\tremaining: 5.92s\n","4670:\tlearn: 0.7639562\ttotal: 1m 21s\tremaining: 5.75s\n","4680:\tlearn: 0.7640337\ttotal: 1m 21s\tremaining: 5.58s\n","4690:\tlearn: 0.7641594\ttotal: 1m 22s\tremaining: 5.4s\n","4700:\tlearn: 0.7641910\ttotal: 1m 22s\tremaining: 5.23s\n","4710:\tlearn: 0.7642551\ttotal: 1m 22s\tremaining: 5.05s\n","4720:\tlearn: 0.7642803\ttotal: 1m 22s\tremaining: 4.88s\n","4730:\tlearn: 0.7643138\ttotal: 1m 22s\tremaining: 4.7s\n","4740:\tlearn: 0.7644169\ttotal: 1m 22s\tremaining: 4.53s\n","4750:\tlearn: 0.7645424\ttotal: 1m 23s\tremaining: 4.35s\n","4760:\tlearn: 0.7646471\ttotal: 1m 23s\tremaining: 4.18s\n","4770:\tlearn: 0.7647311\ttotal: 1m 23s\tremaining: 4s\n","4780:\tlearn: 0.7648097\ttotal: 1m 23s\tremaining: 3.83s\n","4790:\tlearn: 0.7648524\ttotal: 1m 23s\tremaining: 3.65s\n","4800:\tlearn: 0.7648984\ttotal: 1m 23s\tremaining: 3.48s\n","4810:\tlearn: 0.7650146\ttotal: 1m 24s\tremaining: 3.3s\n","4820:\tlearn: 0.7650639\ttotal: 1m 24s\tremaining: 3.13s\n","4830:\tlearn: 0.7651712\ttotal: 1m 24s\tremaining: 2.96s\n","4840:\tlearn: 0.7652647\ttotal: 1m 24s\tremaining: 2.78s\n","4850:\tlearn: 0.7653287\ttotal: 1m 24s\tremaining: 2.61s\n","4860:\tlearn: 0.7653656\ttotal: 1m 25s\tremaining: 2.43s\n","4870:\tlearn: 0.7655226\ttotal: 1m 25s\tremaining: 2.26s\n","4880:\tlearn: 0.7655492\ttotal: 1m 25s\tremaining: 2.08s\n","4890:\tlearn: 0.7656252\ttotal: 1m 25s\tremaining: 1.91s\n","4900:\tlearn: 0.7657005\ttotal: 1m 25s\tremaining: 1.73s\n","4910:\tlearn: 0.7658219\ttotal: 1m 25s\tremaining: 1.56s\n","4920:\tlearn: 0.7659129\ttotal: 1m 26s\tremaining: 1.38s\n","4930:\tlearn: 0.7660476\ttotal: 1m 26s\tremaining: 1.21s\n","4940:\tlearn: 0.7659880\ttotal: 1m 26s\tremaining: 1.03s\n","4950:\tlearn: 0.7661394\ttotal: 1m 26s\tremaining: 857ms\n","4960:\tlearn: 0.7661806\ttotal: 1m 26s\tremaining: 682ms\n","4970:\tlearn: 0.7662203\ttotal: 1m 26s\tremaining: 507ms\n","4980:\tlearn: 0.7663901\ttotal: 1m 27s\tremaining: 332ms\n","4990:\tlearn: 0.7664980\ttotal: 1m 27s\tremaining: 157ms\n","4999:\tlearn: 0.7664957\ttotal: 1m 27s\tremaining: 0us\n","Score on test set\n","\n"," ========================================================\n","0.7448629151397709\n","\n"," Benchmark model was: 0.5815\n"]}]},{"cell_type":"code","source":["%%time\n","\n","voting_clf_hard = VotingClassifier(estimators=[('lgb', modellgb), ('cat', modelcat)], voting='hard', verbose=10)\n","voting_clf_hard.fit(X_train, y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5RH_L7gF6HAC","executionInfo":{"status":"ok","timestamp":1655860670499,"user_tz":180,"elapsed":97939,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"720c85c9-4b2a-49f2-dd2f-517d28e663e4"},"execution_count":13,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning:\n","\n","A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","\n","/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning:\n","\n","A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","\n"]},{"output_type":"stream","name":"stdout","text":["[Voting] ...................... (1 of 2) Processing lgb, total=   6.5s\n","[Voting] ...................... (2 of 2) Processing cat, total= 1.5min\n","CPU times: user 3min 5s, sys: 58.2 s, total: 4min 3s\n","Wall time: 1min 37s\n"]}]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5vwUd0CC_6q9","outputId":"ec2b0524-9bad-49d5-a9ab-d2bcf7026bf5","executionInfo":{"status":"ok","timestamp":1655860767946,"user_tz":180,"elapsed":97494,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning:\n","\n","A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","\n","/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning:\n","\n","A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","\n"]},{"output_type":"stream","name":"stdout","text":["[Voting] ...................... (1 of 2) Processing lgb, total=   7.0s\n","[Voting] ...................... (2 of 2) Processing cat, total= 1.5min\n","CPU times: user 3min 7s, sys: 57.9 s, total: 4min 5s\n","Wall time: 1min 37s\n"]}],"source":["%%time\n","\n","voting_clf = VotingClassifier(estimators=[('lgb', modellgb), ('cat', modelcat)], voting='soft', verbose=10)\n","voting_clf.fit(X_train, y_train)"]},{"cell_type":"code","source":["X_train.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3zzSkejPxQ8F","executionInfo":{"status":"ok","timestamp":1655860767948,"user_tz":180,"elapsed":44,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"9c0f1055-0f93-4e0f-e3e1-3a7f501b8f83"},"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(208480, 68)"]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["voting_clf.predict(X_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tBf43RaPu71k","executionInfo":{"status":"ok","timestamp":1655860769446,"user_tz":180,"elapsed":1537,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"5e00f74b-f3b4-4889-cd8b-e5736a5645c3"},"execution_count":16,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([2, 2, 1, ..., 3, 2, 2])"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["predsvoting=voting_clf.predict(X_test)\n","\n","#f1 score is the metric used in the competition\n","accuracy1=f1_score(y_test,predsvoting,average='micro')\n","print(\"Score on test set\")\n","print(\"\\n ========================================================\")\n","print(accuracy1)\n","print('\\n Benchmark model was: 0.5815')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XadN4rmOuhRp","executionInfo":{"status":"ok","timestamp":1655860770565,"user_tz":180,"elapsed":1126,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"6632dc45-d17d-44bc-c436-ea04c5ab9563"},"execution_count":17,"outputs":[{"output_type":"stream","name":"stdout","text":["Score on test set\n","\n"," ========================================================\n","0.7456879184973427\n","\n"," Benchmark model was: 0.5815\n"]}]},{"cell_type":"markdown","metadata":{"id":"r-I_07_3rzrD"},"source":["# Create Submission File"]},{"cell_type":"code","source":["dummies3 = pd.get_dummies(test_values[[\"land_surface_condition\", \"foundation_type\", \"roof_type\", \"ground_floor_type\", \"other_floor_type\", \"position\", \"plan_configuration\", \"legal_ownership_status\"]])\n","X_test1 = test_values.drop([\"land_surface_condition\", \"foundation_type\", \"roof_type\", \"ground_floor_type\", \"other_floor_type\", \"position\", \"plan_configuration\", \"legal_ownership_status\"], axis = 1)\n","X_test1 = pd.concat([X_test1, dummies3], axis=1)"],"metadata":{"id":"e3gtVY6i4zc_","executionInfo":{"status":"ok","timestamp":1655860770567,"user_tz":180,"elapsed":11,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","execution_count":19,"metadata":{"id":"_6A91fUUmUWc","executionInfo":{"status":"ok","timestamp":1655860772474,"user_tz":180,"elapsed":1916,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"outputs":[],"source":["y_pred = voting_clf.predict(X_test1)"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"O2j1Eb1jmlRD","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1655860772475,"user_tz":180,"elapsed":11,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"594a218f-2f0c-4079-9296-9ccaf5c5e802"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([3, 2, 2, ..., 2, 2, 1])"]},"metadata":{},"execution_count":20}],"source":["y_pred"]},{"cell_type":"code","execution_count":21,"metadata":{"id":"rVHw49-zsHQA","executionInfo":{"status":"ok","timestamp":1655860773580,"user_tz":180,"elapsed":1113,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"outputs":[],"source":["sub_csv = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/submission_format.csv\")\n","\n","sub_csv[\"damage_grade\"] = y_pred\n","sub_csv.to_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/output/submit/voting_soft_cat_e_lgb.csv\", index=False)"]},{"cell_type":"code","execution_count":22,"metadata":{"id":"hz04gMK9x7q4","colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1655860773581,"user_tz":180,"elapsed":26,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"d30231f5-6b23-4b66-b605-92b895b698cf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       building_id  damage_grade\n","0           300051             3\n","1            99355             2\n","2           890251             2\n","3           745817             1\n","4           421793             3\n","...            ...           ...\n","86863       310028             2\n","86864       663567             3\n","86865      1049160             2\n","86866       442785             2\n","86867       501372             1\n","\n","[86868 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-abd180a5-1b87-49e6-8fcc-19066b1ade2a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>damage_grade</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>300051</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>99355</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>890251</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>745817</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>421793</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>86863</th>\n","      <td>310028</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>86864</th>\n","      <td>663567</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>86865</th>\n","      <td>1049160</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>86866</th>\n","      <td>442785</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>86867</th>\n","      <td>501372</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>86868 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-abd180a5-1b87-49e6-8fcc-19066b1ade2a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-abd180a5-1b87-49e6-8fcc-19066b1ade2a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-abd180a5-1b87-49e6-8fcc-19066b1ade2a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":22}],"source":["sub_csv"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FEav9KMuI6PE"},"outputs":[],"source":[""]}],"metadata":{"accelerator":"GPU","colab":{"background_execution":"on","collapsed_sections":["S1SjD-NU1pmB","EzuQlWAIdlLY"],"machine_shape":"hm","name":"Treinamento - Ensemble Model CatBoost e LightGBM","provenance":[],"authorship_tag":"ABX9TyOLxM864ld9HuJs92EmYCgU"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}