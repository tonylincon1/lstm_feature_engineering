{"cells":[{"cell_type":"markdown","source":["# Preparações"],"metadata":{"id":"S1SjD-NU1pmB"}},{"cell_type":"code","source":["!pip install catboost\n","!pip install xgboost"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aXpEo5zReehc","executionInfo":{"status":"ok","timestamp":1656716308979,"user_tz":180,"elapsed":15343,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"536a1006-b065-4c1c-bda9-cd3e097feb6d"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting catboost\n","  Downloading catboost-1.0.6-cp37-none-manylinux1_x86_64.whl (76.6 MB)\n","\u001b[K     |████████████████████████████████| 76.6 MB 80.3 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.21.6)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from catboost) (1.4.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from catboost) (1.15.0)\n","Requirement already satisfied: pandas>=0.24.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.3.5)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.7/dist-packages (from catboost) (0.10.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from catboost) (3.2.2)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from catboost) (5.5.0)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2022.1)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2.8.2)\n","Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (3.0.9)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (0.11.0)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (1.4.3)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver>=1.0.1->matplotlib->catboost) (4.1.1)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.7/dist-packages (from plotly->catboost) (8.0.1)\n","Installing collected packages: catboost\n","Successfully installed catboost-1.0.6\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: xgboost in /usr/local/lib/python3.7/dist-packages (0.90)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from xgboost) (1.21.6)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from xgboost) (1.4.1)\n"]}]},{"cell_type":"code","source":["import os \n","import numpy as np\n","import pandas as pd\n","from tqdm import tqdm\n","from catboost import CatBoostClassifier\n","import xgboost as xgb\n","from sklearn.ensemble import VotingClassifier\n","\n","import lightgbm as lgb\n","\n","import keras \n","from keras.layers import *\n","from keras.optimizers import *\n","from keras.models import Model\n","\n","from sklearn.metrics import f1_score \n","from sklearn.model_selection import KFold\n","from keras import backend as K"],"metadata":{"id":"z6u34g1-cEId","executionInfo":{"status":"ok","timestamp":1656722041681,"user_tz":180,"elapsed":1414,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":47,"outputs":[]},{"cell_type":"code","source":["from google.colab import drive\n","\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pbmv4QPG2mlV","executionInfo":{"status":"ok","timestamp":1656716333733,"user_tz":180,"elapsed":20820,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"83eb183a-2f9d-469c-92ac-adb19a572729"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"markdown","metadata":{"id":"EzuQlWAIdlLY"},"source":["# Preparação"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":2071,"status":"ok","timestamp":1656716335802,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"SmglVpXXQx7w"},"outputs":[],"source":["df_train_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/train_values.csv\")"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":514,"status":"ok","timestamp":1656716336312,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"-owqop2mQ46i"},"outputs":[],"source":["df_train__label_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/train_labels.csv\")"]},{"cell_type":"code","source":["df_teste_values = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/test_values.csv\")"],"metadata":{"id":"ySZDbujXdFdB","executionInfo":{"status":"ok","timestamp":1656716337711,"user_tz":180,"elapsed":1401,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":300},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1656716337712,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"71GSlzD9Q7cY","outputId":"72da0f6f-c2cd-41a4-b8c1-84737a769aee"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   building_id  geo_level_1_id  geo_level_2_id  geo_level_3_id  \\\n","0       802906               6             487           12198   \n","1        28830               8             900            2812   \n","2        94947              21             363            8973   \n","3       590882              22             418           10694   \n","4       201944              11             131            1488   \n","\n","   count_floors_pre_eq  age  area_percentage  height_percentage  \\\n","0                    2   30                6                  5   \n","1                    2   10                8                  7   \n","2                    2   10                5                  5   \n","3                    2   10                6                  5   \n","4                    3   30                8                  9   \n","\n","  land_surface_condition foundation_type  ... has_secondary_use_agriculture  \\\n","0                      t               r  ...                             0   \n","1                      o               r  ...                             0   \n","2                      t               r  ...                             0   \n","3                      t               r  ...                             0   \n","4                      t               r  ...                             0   \n","\n","  has_secondary_use_hotel has_secondary_use_rental  \\\n","0                       0                        0   \n","1                       0                        0   \n","2                       0                        0   \n","3                       0                        0   \n","4                       0                        0   \n","\n","  has_secondary_use_institution has_secondary_use_school  \\\n","0                             0                        0   \n","1                             0                        0   \n","2                             0                        0   \n","3                             0                        0   \n","4                             0                        0   \n","\n","   has_secondary_use_industry  has_secondary_use_health_post  \\\n","0                           0                              0   \n","1                           0                              0   \n","2                           0                              0   \n","3                           0                              0   \n","4                           0                              0   \n","\n","   has_secondary_use_gov_office  has_secondary_use_use_police  \\\n","0                             0                             0   \n","1                             0                             0   \n","2                             0                             0   \n","3                             0                             0   \n","4                             0                             0   \n","\n","   has_secondary_use_other  \n","0                        0  \n","1                        0  \n","2                        0  \n","3                        0  \n","4                        0  \n","\n","[5 rows x 39 columns]"],"text/html":["\n","  <div id=\"df-1612f97d-2fc7-4053-82e6-dfe17b5fa2b0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>geo_level_1_id</th>\n","      <th>geo_level_2_id</th>\n","      <th>geo_level_3_id</th>\n","      <th>count_floors_pre_eq</th>\n","      <th>age</th>\n","      <th>area_percentage</th>\n","      <th>height_percentage</th>\n","      <th>land_surface_condition</th>\n","      <th>foundation_type</th>\n","      <th>...</th>\n","      <th>has_secondary_use_agriculture</th>\n","      <th>has_secondary_use_hotel</th>\n","      <th>has_secondary_use_rental</th>\n","      <th>has_secondary_use_institution</th>\n","      <th>has_secondary_use_school</th>\n","      <th>has_secondary_use_industry</th>\n","      <th>has_secondary_use_health_post</th>\n","      <th>has_secondary_use_gov_office</th>\n","      <th>has_secondary_use_use_police</th>\n","      <th>has_secondary_use_other</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>802906</td>\n","      <td>6</td>\n","      <td>487</td>\n","      <td>12198</td>\n","      <td>2</td>\n","      <td>30</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>28830</td>\n","      <td>8</td>\n","      <td>900</td>\n","      <td>2812</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>o</td>\n","      <td>r</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>94947</td>\n","      <td>21</td>\n","      <td>363</td>\n","      <td>8973</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>590882</td>\n","      <td>22</td>\n","      <td>418</td>\n","      <td>10694</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>201944</td>\n","      <td>11</td>\n","      <td>131</td>\n","      <td>1488</td>\n","      <td>3</td>\n","      <td>30</td>\n","      <td>8</td>\n","      <td>9</td>\n","      <td>t</td>\n","      <td>r</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 39 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1612f97d-2fc7-4053-82e6-dfe17b5fa2b0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1612f97d-2fc7-4053-82e6-dfe17b5fa2b0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1612f97d-2fc7-4053-82e6-dfe17b5fa2b0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}],"source":["df_train_values.head()"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1656716337712,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"nuqKEYpoQ-A-","outputId":"0837e962-9b4f-4b95-a06f-f84a0c143e66"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   building_id  damage_grade\n","0       802906             3\n","1        28830             2\n","2        94947             3\n","3       590882             2\n","4       201944             3"],"text/html":["\n","  <div id=\"df-7b1b28bc-e57b-496a-b108-eb456b35d709\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>damage_grade</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>802906</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>28830</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>94947</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>590882</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>201944</td>\n","      <td>3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7b1b28bc-e57b-496a-b108-eb456b35d709')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7b1b28bc-e57b-496a-b108-eb456b35d709 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7b1b28bc-e57b-496a-b108-eb456b35d709');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["df_train__label_values.head()"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1656716337712,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"U7mZTZ7_Q_5u","outputId":"f306bd54-07b0-4253-fdf0-0ea5a25db037"},"outputs":[{"output_type":"stream","name":"stdout","text":["(260601, 39)\n","(260601, 2)\n"]}],"source":["print(df_train_values.shape)\n","print(df_train__label_values.shape)"]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":535,"status":"ok","timestamp":1656716338242,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"gHl8gsL0RBqS"},"outputs":[],"source":["df_train = pd.merge(df_train_values,df_train__label_values,how='inner',on='building_id')"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1656716338243,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"kGjxs-YNRDUq","outputId":"12aed95a-26f1-4a45-f0cf-5d869dce63cb"},"outputs":[{"output_type":"stream","name":"stdout","text":["(260601, 39)\n","(260601, 2)\n","(260601, 40)\n"]}],"source":["print(df_train_values.shape)\n","print(df_train__label_values.shape)\n","print(df_train.shape)"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1656716338244,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"wiIxHVBEREho","outputId":"3da0e31a-37d8-4658-b88a-bf09a26098ce"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["2    148259\n","3     87218\n","1     25124\n","Name: damage_grade, dtype: int64"]},"metadata":{},"execution_count":12}],"source":["df_train.damage_grade.value_counts()"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1656716338245,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"XUiEdyyDRIzb"},"outputs":[],"source":["target = []\n","\n","for n in df_train.damage_grade:\n","    if n == 1:\n","        target.append(0)\n","    elif n == 2:\n","        target.append(1)\n","    elif n == 3:\n","        target.append(2)"]},{"cell_type":"code","execution_count":14,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1656716338245,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"akbaNL-ZRLBG"},"outputs":[],"source":["df_train[\"damage_grade\"] = target"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1656716338246,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"},"user_tz":180},"id":"4y8zYaYYRNEt","outputId":"e5848334-ea7a-4381-e303-7a696008fca2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["1    148259\n","2     87218\n","0     25124\n","Name: damage_grade, dtype: int64"]},"metadata":{},"execution_count":15}],"source":["df_train.damage_grade.value_counts()"]},{"cell_type":"markdown","source":["# Geographic Location ID Embedding w/ Autoencoder"],"metadata":{"id":"G9kigXvVch-X"}},{"cell_type":"code","source":["train_x = df_train_values\n","train_y = df_train__label_values\n","test_x  = df_teste_values"],"metadata":{"id":"oKJ5OLZvc1e_","executionInfo":{"status":"ok","timestamp":1656716338246,"user_tz":180,"elapsed":9,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["geo1 = np.array(pd.get_dummies(pd.concat([train_x[\"geo_level_1_id\"], test_x[\"geo_level_1_id\"]])))\n","geo2 = np.array(pd.get_dummies(pd.concat([train_x[\"geo_level_2_id\"], test_x[\"geo_level_2_id\"]])))\n","geo3 = np.array(pd.get_dummies(pd.concat([train_x[\"geo_level_3_id\"], test_x[\"geo_level_3_id\"]])))"],"metadata":{"id":"EDcPN3avclU9","executionInfo":{"status":"ok","timestamp":1656716361437,"user_tz":180,"elapsed":23199,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["geo3.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"06zSo8yidPjb","executionInfo":{"status":"ok","timestamp":1656716361438,"user_tz":180,"elapsed":6,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"f62374b6-e1e9-425f-d882-dc439b510f8a"},"execution_count":18,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(347469, 11861)"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","source":["def NET():\n","    inp = Input((geo3.shape[1],))\n","    i1 = Dense(16, name=\"intermediate\")(inp)\n","    x2 = Dense(geo2.shape[1], activation='sigmoid')(i1)\n","    x1 = Dense(geo1.shape[1], activation='sigmoid')(i1)\n","\n","    model = Model(inp, [x2,x1])\n","    model.compile(loss=\"binary_crossentropy\", optimizer=\"adam\")\n","    return model"],"metadata":{"id":"C203IFkvdS8j","executionInfo":{"status":"ok","timestamp":1656716361438,"user_tz":180,"elapsed":3,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["model = NET()\n","model.fit(geo3, [geo2, geo1], batch_size=128, epochs=10, verbose=2)\n","model.save(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/output/models/geo_embed.h5\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"J44zSKmXdU14","executionInfo":{"status":"ok","timestamp":1656716482519,"user_tz":180,"elapsed":121084,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"036f17d1-94d4-4b38-ec5a-711a1f33252e"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","2715/2715 - 14s - loss: 0.2052 - dense_loss: 0.0532 - dense_1_loss: 0.1521 - 14s/epoch - 5ms/step\n","Epoch 2/10\n","2715/2715 - 9s - loss: 0.0541 - dense_loss: 0.0052 - dense_1_loss: 0.0490 - 9s/epoch - 3ms/step\n","Epoch 3/10\n","2715/2715 - 9s - loss: 0.0148 - dense_loss: 0.0042 - dense_1_loss: 0.0106 - 9s/epoch - 3ms/step\n","Epoch 4/10\n","2715/2715 - 9s - loss: 0.0068 - dense_loss: 0.0035 - dense_1_loss: 0.0033 - 9s/epoch - 3ms/step\n","Epoch 5/10\n","2715/2715 - 9s - loss: 0.0043 - dense_loss: 0.0030 - dense_1_loss: 0.0013 - 9s/epoch - 3ms/step\n","Epoch 6/10\n","2715/2715 - 9s - loss: 0.0030 - dense_loss: 0.0024 - dense_1_loss: 6.0697e-04 - 9s/epoch - 3ms/step\n","Epoch 7/10\n","2715/2715 - 9s - loss: 0.0020 - dense_loss: 0.0016 - dense_1_loss: 3.1642e-04 - 9s/epoch - 3ms/step\n","Epoch 8/10\n","2715/2715 - 9s - loss: 0.0013 - dense_loss: 0.0011 - dense_1_loss: 1.6828e-04 - 9s/epoch - 3ms/step\n","Epoch 9/10\n","2715/2715 - 9s - loss: 8.2075e-04 - dense_loss: 7.3082e-04 - dense_1_loss: 8.9931e-05 - 9s/epoch - 3ms/step\n","Epoch 10/10\n","2715/2715 - 9s - loss: 5.6108e-04 - dense_loss: 5.1181e-04 - dense_1_loss: 4.9265e-05 - 9s/epoch - 3ms/step\n"]}]},{"cell_type":"code","source":["model = NET()\n","model.load_weights(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/output/models/geo_embed.h5\")"],"metadata":{"id":"KgLJ5jsidaa2","executionInfo":{"status":"ok","timestamp":1656716482519,"user_tz":180,"elapsed":31,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["get_int_layer_output = K.function([model.layers[0].input],\n","                                  [model.layers[1].output])"],"metadata":{"id":"efMxpf0Ods9u","executionInfo":{"status":"ok","timestamp":1656716482520,"user_tz":180,"elapsed":9,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":22,"outputs":[]},{"cell_type":"code","source":["model.layers[0].input"],"metadata":{"id":"R49ADtm9gREc","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1656716482520,"user_tz":180,"elapsed":8,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"553d1bb8-6af6-4e4c-a60f-8bc4f268890f"},"execution_count":23,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<KerasTensor: shape=(None, 11861) dtype=float32 (created by layer 'input_2')>"]},"metadata":{},"execution_count":23}]},{"cell_type":"code","source":["out = []\n","\n","contador = 0\n","for dat in tqdm(range(1,len(geo3[:260601]))):\n","    dat = geo3[contador:dat]\n","    layer_output = get_int_layer_output([[dat]])[0]\n","    out.append(layer_output)\n","    contador = contador + 1\n","\n","out = np.array(out)\n","out = np.squeeze(out)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eWA-zWUddypC","executionInfo":{"status":"ok","timestamp":1656716829337,"user_tz":180,"elapsed":346824,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"2b3b57d5-49a9-4b27-eb06-50d7ac2c4379"},"execution_count":24,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 260600/260600 [05:46<00:00, 751.32it/s]\n"]}]},{"cell_type":"code","source":["train_x = train_x[:260600]\n","train_data = pd.get_dummies(train_x.copy())\n","train_data = train_data[:260600]"],"metadata":{"id":"RHG7kc9goNFA","executionInfo":{"status":"ok","timestamp":1656716829833,"user_tz":180,"elapsed":509,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["train_data = pd.get_dummies(train_x.copy())\n","train_data = train_data.drop(['geo_level_1_id', 'geo_level_2_id', 'geo_level_3_id'], axis=1)\n","train_data = train_data.assign(geo_feat1=out[:,0],\n","                               geo_feat2=out[:,1],\n","                               geo_feat3=out[:,2],  \n","                               geo_feat4=out[:,3],\n","                               geo_feat5=out[:,4],    \n","                               geo_feat6=out[:,5],\n","                               geo_feat7=out[:,6],\n","                               geo_feat8=out[:,7],\n","                               geo_feat9=out[:,8],\n","                               geo_feat10=out[:,9],\n","                               geo_feat11=out[:,10],\n","                               geo_feat12=out[:,11],\n","                               geo_feat13=out[:,12],\n","                               geo_feat14=out[:,13],\n","                               geo_feat15=out[:,14],           \n","                               geo_feat16=out[:,15])"],"metadata":{"id":"H3HBtgNDftzM","executionInfo":{"status":"ok","timestamp":1656716830382,"user_tz":180,"elapsed":551,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["train_data.columns"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mOEKRt8JoJge","executionInfo":{"status":"ok","timestamp":1656716830383,"user_tz":180,"elapsed":22,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"00e96e05-121a-4272-ad76-0204f277bcab"},"execution_count":27,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['building_id', 'count_floors_pre_eq', 'age', 'area_percentage',\n","       'height_percentage', 'has_superstructure_adobe_mud',\n","       'has_superstructure_mud_mortar_stone', 'has_superstructure_stone_flag',\n","       'has_superstructure_cement_mortar_stone',\n","       'has_superstructure_mud_mortar_brick',\n","       'has_superstructure_cement_mortar_brick', 'has_superstructure_timber',\n","       'has_superstructure_bamboo', 'has_superstructure_rc_non_engineered',\n","       'has_superstructure_rc_engineered', 'has_superstructure_other',\n","       'count_families', 'has_secondary_use', 'has_secondary_use_agriculture',\n","       'has_secondary_use_hotel', 'has_secondary_use_rental',\n","       'has_secondary_use_institution', 'has_secondary_use_school',\n","       'has_secondary_use_industry', 'has_secondary_use_health_post',\n","       'has_secondary_use_gov_office', 'has_secondary_use_use_police',\n","       'has_secondary_use_other', 'land_surface_condition_n',\n","       'land_surface_condition_o', 'land_surface_condition_t',\n","       'foundation_type_h', 'foundation_type_i', 'foundation_type_r',\n","       'foundation_type_u', 'foundation_type_w', 'roof_type_n', 'roof_type_q',\n","       'roof_type_x', 'ground_floor_type_f', 'ground_floor_type_m',\n","       'ground_floor_type_v', 'ground_floor_type_x', 'ground_floor_type_z',\n","       'other_floor_type_j', 'other_floor_type_q', 'other_floor_type_s',\n","       'other_floor_type_x', 'position_j', 'position_o', 'position_s',\n","       'position_t', 'plan_configuration_a', 'plan_configuration_c',\n","       'plan_configuration_d', 'plan_configuration_f', 'plan_configuration_m',\n","       'plan_configuration_n', 'plan_configuration_o', 'plan_configuration_q',\n","       'plan_configuration_s', 'plan_configuration_u',\n","       'legal_ownership_status_a', 'legal_ownership_status_r',\n","       'legal_ownership_status_v', 'legal_ownership_status_w', 'geo_feat1',\n","       'geo_feat2', 'geo_feat3', 'geo_feat4', 'geo_feat5', 'geo_feat6',\n","       'geo_feat7', 'geo_feat8', 'geo_feat9', 'geo_feat10', 'geo_feat11',\n","       'geo_feat12', 'geo_feat13', 'geo_feat14', 'geo_feat15', 'geo_feat16'],\n","      dtype='object')"]},"metadata":{},"execution_count":27}]},{"cell_type":"code","source":["def threshold_arr(array):\n","    new_arr = []\n","    for ix, val in enumerate(array):\n","        loc = np.array(val).argmax(axis=0)\n","        k = list(np.zeros((len(val))))\n","        k[loc]=1\n","        new_arr.append(k)\n","        \n","    return np.array(new_arr)"],"metadata":{"id":"qfYzo2b9oksI","executionInfo":{"status":"ok","timestamp":1656716830383,"user_tz":180,"elapsed":16,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","source":["y = np.array(train_y[\"damage_grade\"][:-1])-1\n","\n","df = train_data.drop([\"building_id\"], axis=1)\n","x = np.array(df)"],"metadata":{"id":"wQRTmIIieRsc","executionInfo":{"status":"ok","timestamp":1656716830384,"user_tz":180,"elapsed":16,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["from sklearn.metrics import f1_score\n","from sklearn.model_selection import train_test_split\n","\n","print(\"Resample the train test split & try these parameters set\")\n","X_train = df\n","y = y\n","X_train, X_test, y_train, y_test = train_test_split(X_train, y, test_size=0.20)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"C_Ri-WoDg6Vh","executionInfo":{"status":"ok","timestamp":1656716830384,"user_tz":180,"elapsed":15,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"fa68d4d1-9e79-451d-b467-ad09371a8e8b"},"execution_count":30,"outputs":[{"output_type":"stream","name":"stdout","text":["Resample the train test split & try these parameters set\n"]}]},{"cell_type":"markdown","source":["# LightGBM Training"],"metadata":{"id":"nFc4bb3ZoehJ"}},{"cell_type":"code","source":["y = np.array(train_y[\"damage_grade\"])-1\n","\n","df = train_data.drop([\"building_id\"], axis=1)\n","x = np.array(df)\n","\n","kf = KFold(n_splits=5, shuffle=True, random_state=232)\n","for ix, (train_index, test_index) in enumerate(kf.split(x)):\n","    lgb_params = {\n","        \"objective\" : \"multiclass\",\n","        \"num_class\":3,\n","        \"metric\" : \"multi_error\",\n","        \"boosting\": 'gbdt',\n","        \"max_depth\" : -1,\n","        \"num_leaves\" : 30,\n","        \"learning_rate\" : 0.1,\n","        \"feature_fraction\" : 0.5,\n","        \"min_sum_hessian_in_leaf\" : 0.1,\n","        \"max_bin\":8192,\n","        \"verbosity\" : 1,\n","        \"num_threads\":6,\n","        \"seed\": 232\n","    }\n","\n","    x_train, x_val, y_train, y_val = x[train_index], x[test_index], y[train_index], y[test_index]\n","\n","    train_data = lgb.Dataset(x_train, label=y_train)\n","    val_data   = lgb.Dataset(x_val, label=y_val)\n","\n","    lgb_clf = lgb.train(lgb_params,\n","                        train_data,\n","                        20000,\n","                        valid_sets = [val_data],\n","                        early_stopping_rounds=3000,\n","                        verbose_eval = 1000)\n","\n","    y_pred = lgb_clf.predict(x_val)\n","    print(\"F1-MICRO SCORE: \", f1_score(np.array(pd.get_dummies(y_val)), threshold_arr(y_pred), average='micro'))\n","    lgb_clf.save_model(f\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/output/models/model{ix}.txt\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ulNyjE_HKy21","executionInfo":{"status":"ok","timestamp":1656721763469,"user_tz":180,"elapsed":2356336,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"cec29476-f31c-45c9-f32c-258aa3fbf984"},"execution_count":43,"outputs":[{"output_type":"stream","name":"stdout","text":["Training until validation scores don't improve for 3000 rounds.\n","[1000]\tvalid_0's multi_error: 0.251151\n","[2000]\tvalid_0's multi_error: 0.248388\n","[3000]\tvalid_0's multi_error: 0.248388\n","[4000]\tvalid_0's multi_error: 0.250633\n","[5000]\tvalid_0's multi_error: 0.251477\n","[6000]\tvalid_0's multi_error: 0.252283\n","Early stopping, best iteration is:\n","[3120]\tvalid_0's multi_error: 0.247889\n","F1-MICRO SCORE:  0.7521105141980046\n","Training until validation scores don't improve for 3000 rounds.\n","[1000]\tvalid_0's multi_error: 0.250825\n","[2000]\tvalid_0's multi_error: 0.248964\n","[3000]\tvalid_0's multi_error: 0.248695\n","[4000]\tvalid_0's multi_error: 0.24906\n","[5000]\tvalid_0's multi_error: 0.249981\n","[6000]\tvalid_0's multi_error: 0.251132\n","Early stopping, best iteration is:\n","[3411]\tvalid_0's multi_error: 0.248043\n","F1-MICRO SCORE:  0.7519570222563315\n","Training until validation scores don't improve for 3000 rounds.\n","[1000]\tvalid_0's multi_error: 0.247391\n","[2000]\tvalid_0's multi_error: 0.245376\n","[3000]\tvalid_0's multi_error: 0.246086\n","[4000]\tvalid_0's multi_error: 0.247889\n","Early stopping, best iteration is:\n","[1794]\tvalid_0's multi_error: 0.244705\n","F1-MICRO SCORE:  0.7552954719877206\n","Training until validation scores don't improve for 3000 rounds.\n","[1000]\tvalid_0's multi_error: 0.249194\n","[2000]\tvalid_0's multi_error: 0.247851\n","[3000]\tvalid_0's multi_error: 0.247813\n","[4000]\tvalid_0's multi_error: 0.248734\n","[5000]\tvalid_0's multi_error: 0.249616\n","Early stopping, best iteration is:\n","[2171]\tvalid_0's multi_error: 0.247218\n","F1-MICRO SCORE:  0.7527820414428242\n","Training until validation scores don't improve for 3000 rounds.\n","[1000]\tvalid_0's multi_error: 0.25282\n","[2000]\tvalid_0's multi_error: 0.250153\n","[3000]\tvalid_0's multi_error: 0.250537\n","[4000]\tvalid_0's multi_error: 0.251861\n","[5000]\tvalid_0's multi_error: 0.252955\n","Early stopping, best iteration is:\n","[2427]\tvalid_0's multi_error: 0.249578\n","F1-MICRO SCORE:  0.7504221028396009\n"]}]},{"cell_type":"code","source":["y = np.array(train_y[\"damage_grade\"])-1\n","\n","#df = train_data.drop([\"building_id\"], axis=1)\n","x = np.array(df)\n","\n","models = []\n","for i in range(5):\n","    model = lgb.Booster(model_file=f\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/output/models/model{i}.txt\")\n","\n","    y_pred = model.predict(x)\n","    score  = f1_score(np.array(pd.get_dummies(y[:-1])), threshold_arr(y_pred), average='micro')\n","    print(\"F1-MICRO SCORE: \", score)\n","    models.append(model)"],"metadata":{"id":"r0YL6hnboc4q","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1656721912844,"user_tz":180,"elapsed":136950,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"c3612e55-1f30-405e-aa49-85d42e90487e"},"execution_count":45,"outputs":[{"output_type":"stream","name":"stdout","text":["F1-MICRO SCORE:  0.8269915579432079\n","F1-MICRO SCORE:  0.8306446661550269\n","F1-MICRO SCORE:  0.8030621642363776\n","F1-MICRO SCORE:  0.8105065234075209\n","F1-MICRO SCORE:  0.815176515732924\n"]}]},{"cell_type":"code","source":["def ensemble(models, x):\n","    y_preds = []\n","    \n","    for model in models:\n","        y_pred = model.predict(x)\n","        y_preds.append(y_pred)\n","        \n","    init_y_pred = y_preds[0]\n","    for ypred in y_preds[1:]:\n","        init_y_pred += ypred\n","        \n","    y_pred = threshold_arr(init_y_pred)\n","    \n","    return y_pred"],"metadata":{"id":"lDQWc7oQ_VHC","executionInfo":{"status":"ok","timestamp":1656722980418,"user_tz":180,"elapsed":525,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":77,"outputs":[]},{"cell_type":"code","source":["y_pred = ensemble(models, x)\n","y_pred = y_pred.argmax(axis=1)+1"],"metadata":{"id":"oK_waHQo_V3W","executionInfo":{"status":"ok","timestamp":1656723050365,"user_tz":180,"elapsed":44087,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":78,"outputs":[]},{"cell_type":"code","source":["y_pred"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1E1tYIDGYvCD","executionInfo":{"status":"ok","timestamp":1656723050368,"user_tz":180,"elapsed":35,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"08eedf4c-a59c-40e6-a9af-bbb190f8302c"},"execution_count":79,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([3, 2, 3, ..., 2, 3, 3])"]},"metadata":{},"execution_count":79}]},{"cell_type":"code","source":["models[0].predict(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YaD7RQBqB3mb","executionInfo":{"status":"ok","timestamp":1656722282184,"user_tz":180,"elapsed":31985,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"3da2a832-f710-457b-fad6-8ea30f238c0e"},"execution_count":51,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[9.06137848e-04, 2.17267421e-01, 7.81826441e-01],\n","       [1.26241511e-03, 8.64170632e-01, 1.34566953e-01],\n","       [2.29397845e-03, 2.36407463e-01, 7.61298558e-01],\n","       ...,\n","       [2.18033770e-03, 3.06763150e-02, 9.67143347e-01],\n","       [1.12449273e-04, 7.64420866e-03, 9.92243342e-01],\n","       [2.49300138e-01, 7.48299198e-01, 2.40066415e-03]])"]},"metadata":{},"execution_count":51}]},{"cell_type":"markdown","source":["# Treinamento de Outros Modelos"],"metadata":{"id":"gAromyT2do24"}},{"cell_type":"code","source":["#input best params here from randm.best_params_\n","\n","modelxgb_cl = xgb.XGBClassifier(random_state=42,objective='multi:softmax', gamma=0.001369048068388758, eta=0.11,\n","                  max_depth= 20,\n","                  min_child_weight=9,\n","                  num_class= 4,\n","                  subsample= .85,\n","                  colsample_bytree= .9, verbose=10)\n","modelxgb_cl.fit(X_train, y_train)\n","\n","predsxgb_cl=modelxgb_cl.predict(X_test)"],"metadata":{"id":"mU53LpcJdnxa","executionInfo":{"status":"ok","timestamp":1656718065629,"user_tz":180,"elapsed":1063757,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":34,"outputs":[]},{"cell_type":"code","source":["#f1 score is the metric used in the competition\n","accuracy1=f1_score(y_test,predsxgb_cl,average='micro')\n","print(\"Score on test set\")\n","print(\"\\n ========================================================\")\n","print(accuracy1)\n","print('\\n Benchmark model was: 0.5815')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3EP2Zw0Mn72V","executionInfo":{"status":"ok","timestamp":1656718065630,"user_tz":180,"elapsed":31,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"f86ee535-bbee-400d-a4b8-f103e2cb1ce5"},"execution_count":35,"outputs":[{"output_type":"stream","name":"stdout","text":["Score on test set\n","\n"," ========================================================\n","0.7512087490406754\n","\n"," Benchmark model was: 0.5815\n"]}]},{"cell_type":"markdown","source":["# Votting"],"metadata":{"id":"Wjfepqh_UqqZ"}},{"cell_type":"code","source":["%%time\n","\n","voting_clf = VotingClassifier(estimators=[('xgb', modelxgb_cl),\n","                                          ('lgb1', models[0]),\n","                                          ('lgb2', models[1]),\n","                                          ('lgb3', models[2]),\n","                                          ('lgb4', models[3]),\n","                                          ('lgb5', models[4])], voting='soft', verbose=10)\n","voting_clf.fit(X_train, y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":399},"id":"WdaLi5wrUs89","executionInfo":{"status":"error","timestamp":1656722058307,"user_tz":180,"elapsed":384,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"79a1ad8a-21ea-401c-d5cb-cece0ab2e9e1"},"execution_count":48,"outputs":[{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-48-fd670c4ae0a1>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mget_ipython\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrun_cell_magic\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'time'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m''\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"\\nvoting_clf = VotingClassifier(estimators=[('xgb', modelxgb_cl),\\n                                          ('lgb1', models[0]),\\n                                          ('lgb2', models[1]),\\n                                          ('lgb3', models[2]),\\n                                          ('lgb4', models[3]),\\n                                          ('lgb5', models[4])], voting='soft', verbose=10)\\nvoting_clf.fit(X_train, y_train)\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\u001b[0m in \u001b[0;36mrun_cell_magic\u001b[0;34m(self, magic_name, line, cell)\u001b[0m\n\u001b[1;32m   2115\u001b[0m             \u001b[0mmagic_arg_s\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvar_expand\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mline\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstack_depth\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2116\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbuiltin_trap\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2117\u001b[0;31m                 \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmagic_arg_s\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcell\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2118\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2119\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<decorator-gen-53>\u001b[0m in \u001b[0;36mtime\u001b[0;34m(self, line, cell, local_ns)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/IPython/core/magic.py\u001b[0m in \u001b[0;36m<lambda>\u001b[0;34m(f, *a, **k)\u001b[0m\n\u001b[1;32m    186\u001b[0m     \u001b[0;31m# but it's overkill for just that one bit of state.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    187\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mmagic_deco\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 188\u001b[0;31m         \u001b[0mcall\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mlambda\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    189\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    190\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mcallable\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/IPython/core/magics/execution.py\u001b[0m in \u001b[0;36mtime\u001b[0;34m(self, line, cell, local_ns)\u001b[0m\n\u001b[1;32m   1191\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1192\u001b[0m             \u001b[0mst\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mclock2\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1193\u001b[0;31m             \u001b[0mexec\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcode\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mglob\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlocal_ns\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1194\u001b[0m             \u001b[0mend\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mclock2\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1195\u001b[0m             \u001b[0mout\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<timed exec>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/ensemble/_voting.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[1;32m    322\u001b[0m         \u001b[0mtransformed_y\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mle_\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtransform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    323\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 324\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtransformed_y\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    325\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    326\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/ensemble/_voting.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[1;32m     63\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     64\u001b[0m         \u001b[0;34m\"\"\"Get common fit operations.\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 65\u001b[0;31m         \u001b[0mnames\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mclfs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_validate_estimators\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     66\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     67\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mweights\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mweights\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mestimators\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/sklearn/ensemble/_base.py\u001b[0m in \u001b[0;36m_validate_estimators\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    262\u001b[0m                 raise ValueError(\n\u001b[1;32m    263\u001b[0m                     \"The estimator {} should be a {}.\".format(\n\u001b[0;32m--> 264\u001b[0;31m                         \u001b[0mest\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__class__\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__name__\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mis_estimator_type\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__name__\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    265\u001b[0m                     )\n\u001b[1;32m    266\u001b[0m                 )\n","\u001b[0;31mValueError\u001b[0m: The estimator Booster should be a classifier."]}]},{"cell_type":"markdown","source":["# Create Submission File"],"metadata":{"id":"r-I_07_3rzrD"}},{"cell_type":"code","source":["out = []\n","\n","contador = 0\n","for dat in tqdm(range(1,len(geo3[260601:]))):\n","    dat = geo3[contador:dat]\n","    layer_output = get_int_layer_output([[dat]])[0]\n","    out.append(layer_output)\n","    contador = contador + 1\n","\n","out = np.array(out)\n","out = np.squeeze(out)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tzAdkqJvsYbl","executionInfo":{"status":"ok","timestamp":1656722631443,"user_tz":180,"elapsed":112867,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"491eaacf-7492-4793-b796-97faa26a1c6e"},"execution_count":55,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 86867/86867 [01:52<00:00, 772.06it/s]\n"]}]},{"cell_type":"code","source":["test_x = test_x[:86867]\n","test_data = test_x[:86867]"],"metadata":{"id":"GhO3xVmKsZQg","executionInfo":{"status":"ok","timestamp":1656722672974,"user_tz":180,"elapsed":516,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":59,"outputs":[]},{"cell_type":"code","source":["#test_data[:86867]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":488},"id":"AzQbwcC24xpx","executionInfo":{"status":"ok","timestamp":1654600848445,"user_tz":180,"elapsed":13,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"684c2499-456e-4faf-eaaf-aa01bc6025a2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       building_id  count_floors_pre_eq  age  area_percentage  \\\n","0           300051                    3   20                7   \n","1            99355                    2   25               13   \n","2           890251                    2    5                4   \n","3           745817                    1    0               19   \n","4           421793                    3   15                8   \n","...            ...                  ...  ...              ...   \n","86862       640115                    2    5               16   \n","86863       310028                    3   70               20   \n","86864       663567                    3   25                6   \n","86865      1049160                    1   50                3   \n","86866       442785                    2    5                9   \n","\n","       height_percentage  has_superstructure_adobe_mud  \\\n","0                      6                             0   \n","1                      5                             0   \n","2                      5                             0   \n","3                      3                             0   \n","4                      7                             0   \n","...                  ...                           ...   \n","86862                  5                             0   \n","86863                  6                             0   \n","86864                  7                             1   \n","86865                  3                             0   \n","86866                  5                             1   \n","\n","       has_superstructure_mud_mortar_stone  has_superstructure_stone_flag  \\\n","0                                        1                              0   \n","1                                        1                              0   \n","2                                        1                              0   \n","3                                        0                              0   \n","4                                        1                              0   \n","...                                    ...                            ...   \n","86862                                    0                              0   \n","86863                                    1                              0   \n","86864                                    1                              1   \n","86865                                    1                              0   \n","86866                                    1                              0   \n","\n","       has_superstructure_cement_mortar_stone  \\\n","0                                           0   \n","1                                           0   \n","2                                           0   \n","3                                           0   \n","4                                           0   \n","...                                       ...   \n","86862                                       0   \n","86863                                       0   \n","86864                                       0   \n","86865                                       0   \n","86866                                       0   \n","\n","       has_superstructure_mud_mortar_brick  \\\n","0                                        0   \n","1                                        0   \n","2                                        0   \n","3                                        0   \n","4                                        0   \n","...                                    ...   \n","86862                                    0   \n","86863                                    0   \n","86864                                    0   \n","86865                                    0   \n","86866                                    0   \n","\n","       has_superstructure_cement_mortar_brick  has_superstructure_timber  \\\n","0                                           0                          0   \n","1                                           0                          0   \n","2                                           0                          0   \n","3                                           1                          0   \n","4                                           0                          0   \n","...                                       ...                        ...   \n","86862                                       0                          0   \n","86863                                       0                          1   \n","86864                                       0                          0   \n","86865                                       0                          1   \n","86866                                       0                          0   \n","\n","       has_superstructure_bamboo  has_superstructure_rc_non_engineered  \\\n","0                              0                                     0   \n","1                              0                                     0   \n","2                              0                                     0   \n","3                              0                                     0   \n","4                              0                                     0   \n","...                          ...                                   ...   \n","86862                          0                                     0   \n","86863                          0                                     0   \n","86864                          0                                     0   \n","86865                          0                                     0   \n","86866                          0                                     0   \n","\n","       has_superstructure_rc_engineered  has_superstructure_other  \\\n","0                                     0                         0   \n","1                                     0                         0   \n","2                                     0                         0   \n","3                                     0                         0   \n","4                                     0                         0   \n","...                                 ...                       ...   \n","86862                                 1                         0   \n","86863                                 0                         0   \n","86864                                 0                         0   \n","86865                                 0                         0   \n","86866                                 0                         0   \n","\n","       count_families  has_secondary_use  has_secondary_use_agriculture  \\\n","0                   1                  0                              0   \n","1                   1                  1                              1   \n","2                   1                  0                              0   \n","3                   2                  1                              0   \n","4                   1                  0                              0   \n","...               ...                ...                            ...   \n","86862               2                  1                              0   \n","86863               1                  1                              1   \n","86864               1                  0                              0   \n","86865               1                  0                              0   \n","86866               1                  0                              0   \n","\n","       has_secondary_use_hotel  has_secondary_use_rental  \\\n","0                            0                         0   \n","1                            0                         0   \n","2                            0                         0   \n","3                            0                         1   \n","4                            0                         0   \n","...                        ...                       ...   \n","86862                        1                         0   \n","86863                        0                         0   \n","86864                        0                         0   \n","86865                        0                         0   \n","86866                        0                         0   \n","\n","       has_secondary_use_institution  has_secondary_use_school  \\\n","0                                  0                         0   \n","1                                  0                         0   \n","2                                  0                         0   \n","3                                  0                         0   \n","4                                  0                         0   \n","...                              ...                       ...   \n","86862                              0                         0   \n","86863                              0                         0   \n","86864                              0                         0   \n","86865                              0                         0   \n","86866                              0                         0   \n","\n","       has_secondary_use_industry  has_secondary_use_health_post  \\\n","0                               0                              0   \n","1                               0                              0   \n","2                               0                              0   \n","3                               0                              0   \n","4                               0                              0   \n","...                           ...                            ...   \n","86862                           0                              0   \n","86863                           0                              0   \n","86864                           0                              0   \n","86865                           0                              0   \n","86866                           0                              0   \n","\n","       has_secondary_use_gov_office  has_secondary_use_use_police  \\\n","0                                 0                             0   \n","1                                 0                             0   \n","2                                 0                             0   \n","3                                 0                             0   \n","4                                 0                             0   \n","...                             ...                           ...   \n","86862                             0                             0   \n","86863                             0                             0   \n","86864                             0                             0   \n","86865                             0                             0   \n","86866                             0                             0   \n","\n","       has_secondary_use_other  land_surface_condition_n  \\\n","0                            0                         0   \n","1                            0                         0   \n","2                            0                         0   \n","3                            0                         0   \n","4                            0                         0   \n","...                        ...                       ...   \n","86862                        0                         0   \n","86863                        0                         0   \n","86864                        0                         1   \n","86865                        0                         0   \n","86866                        0                         0   \n","\n","       land_surface_condition_o  land_surface_condition_t  foundation_type_h  \\\n","0                             0                         1                  0   \n","1                             0                         1                  0   \n","2                             0                         1                  0   \n","3                             0                         1                  0   \n","4                             0                         1                  0   \n","...                         ...                       ...                ...   \n","86862                         0                         1                  0   \n","86863                         0                         1                  0   \n","86864                         0                         0                  0   \n","86865                         0                         1                  0   \n","86866                         0                         1                  0   \n","\n","       foundation_type_i  foundation_type_r  foundation_type_u  \\\n","0                      0                  1                  0   \n","1                      0                  1                  0   \n","2                      0                  1                  0   \n","3                      0                  1                  0   \n","4                      0                  1                  0   \n","...                  ...                ...                ...   \n","86862                  1                  0                  0   \n","86863                  0                  1                  0   \n","86864                  0                  1                  0   \n","86865                  0                  1                  0   \n","86866                  0                  1                  0   \n","\n","       foundation_type_w  roof_type_n  roof_type_q  roof_type_x  \\\n","0                      0            1            0            0   \n","1                      0            1            0            0   \n","2                      0            1            0            0   \n","3                      0            0            0            1   \n","4                      0            0            1            0   \n","...                  ...          ...          ...          ...   \n","86862                  0            0            0            1   \n","86863                  0            0            1            0   \n","86864                  0            1            0            0   \n","86865                  0            1            0            0   \n","86866                  0            1            0            0   \n","\n","       ground_floor_type_f  ground_floor_type_m  ground_floor_type_v  \\\n","0                        1                    0                    0   \n","1                        1                    0                    0   \n","2                        1                    0                    0   \n","3                        0                    0                    1   \n","4                        1                    0                    0   \n","...                    ...                  ...                  ...   \n","86862                    0                    0                    1   \n","86863                    1                    0                    0   \n","86864                    1                    0                    0   \n","86865                    1                    0                    0   \n","86866                    1                    0                    0   \n","\n","       ground_floor_type_x  ground_floor_type_z  other_floor_type_j  \\\n","0                        0                    0                   0   \n","1                        0                    0                   0   \n","2                        0                    0                   0   \n","3                        0                    0                   1   \n","4                        0                    0                   0   \n","...                    ...                  ...                 ...   \n","86862                    0                    0                   0   \n","86863                    0                    0                   0   \n","86864                    0                    0                   0   \n","86865                    0                    0                   1   \n","86866                    0                    0                   0   \n","\n","       other_floor_type_q  other_floor_type_s  other_floor_type_x  position_j  \\\n","0                       1                   0                   0           0   \n","1                       1                   0                   0           0   \n","2                       1                   0                   0           0   \n","3                       0                   0                   0           0   \n","4                       1                   0                   0           0   \n","...                   ...                 ...                 ...         ...   \n","86862                   0                   1                   0           0   \n","86863                   1                   0                   0           0   \n","86864                   1                   0                   0           0   \n","86865                   0                   0                   0           0   \n","86866                   1                   0                   0           0   \n","\n","       position_o  position_s  position_t  plan_configuration_a  \\\n","0               0           1           0                     0   \n","1               0           1           0                     0   \n","2               0           1           0                     0   \n","3               0           0           1                     0   \n","4               0           0           1                     0   \n","...           ...         ...         ...                   ...   \n","86862           0           1           0                     0   \n","86863           0           0           1                     0   \n","86864           0           1           0                     0   \n","86865           0           1           0                     0   \n","86866           0           1           0                     0   \n","\n","       plan_configuration_c  plan_configuration_d  plan_configuration_f  \\\n","0                         0                     1                     0   \n","1                         0                     1                     0   \n","2                         0                     1                     0   \n","3                         0                     1                     0   \n","4                         0                     1                     0   \n","...                     ...                   ...                   ...   \n","86862                     0                     1                     0   \n","86863                     0                     1                     0   \n","86864                     0                     1                     0   \n","86865                     0                     1                     0   \n","86866                     0                     1                     0   \n","\n","       plan_configuration_m  plan_configuration_n  plan_configuration_o  \\\n","0                         0                     0                     0   \n","1                         0                     0                     0   \n","2                         0                     0                     0   \n","3                         0                     0                     0   \n","4                         0                     0                     0   \n","...                     ...                   ...                   ...   \n","86862                     0                     0                     0   \n","86863                     0                     0                     0   \n","86864                     0                     0                     0   \n","86865                     0                     0                     0   \n","86866                     0                     0                     0   \n","\n","       plan_configuration_q  plan_configuration_s  plan_configuration_u  \\\n","0                         0                     0                     0   \n","1                         0                     0                     0   \n","2                         0                     0                     0   \n","3                         0                     0                     0   \n","4                         0                     0                     0   \n","...                     ...                   ...                   ...   \n","86862                     0                     0                     0   \n","86863                     0                     0                     0   \n","86864                     0                     0                     0   \n","86865                     0                     0                     0   \n","86866                     0                     0                     0   \n","\n","       legal_ownership_status_a  legal_ownership_status_r  \\\n","0                             0                         0   \n","1                             0                         0   \n","2                             0                         0   \n","3                             0                         0   \n","4                             0                         0   \n","...                         ...                       ...   \n","86862                         0                         0   \n","86863                         0                         0   \n","86864                         0                         0   \n","86865                         0                         0   \n","86866                         1                         0   \n","\n","       legal_ownership_status_v  legal_ownership_status_w  geo_feat1  \\\n","0                             1                         0   0.418456   \n","1                             1                         0   0.455311   \n","2                             1                         0   2.280500   \n","3                             1                         0   1.080158   \n","4                             1                         0   2.151010   \n","...                         ...                       ...        ...   \n","86862                         1                         0   1.162097   \n","86863                         0                         1  -0.268243   \n","86864                         1                         0   1.557673   \n","86865                         1                         0   2.858545   \n","86866                         0                         0   0.546904   \n","\n","       geo_feat2  geo_feat3  geo_feat4  geo_feat5  geo_feat6  geo_feat7  \\\n","0       1.573474   0.290186   1.385418   2.044306  -1.233857   0.814495   \n","1       1.653826  -0.590032   0.484869   0.953778  -1.714527  -1.081662   \n","2       1.703398   0.170643  -1.149626   1.375152  -1.844418  -1.130349   \n","3       1.392113   0.498317   1.876048  -0.296989  -0.978631  -1.237250   \n","4       2.266077  -1.196271   2.337579   1.290038   0.526027  -1.385312   \n","...          ...        ...        ...        ...        ...        ...   \n","86862  -0.461051  -1.256883   1.228462   1.243536  -0.264460  -1.804007   \n","86863   2.145258  -1.216704   1.807258   1.630791  -1.105302  -0.913516   \n","86864   0.848439  -0.980984   1.096915   1.429782  -1.091510  -0.827044   \n","86865   2.046307  -1.072755   2.094065  -0.597801  -1.782723   0.289512   \n","86866   1.652503  -0.546745   0.697128  -0.011629   0.804628  -0.431198   \n","\n","       geo_feat8  geo_feat9  geo_feat10  geo_feat11  geo_feat12  geo_feat13  \\\n","0       1.759849   2.147925    0.117935    0.280309   -2.010242   -1.553949   \n","1       1.631580  -0.319924   -1.035920   -1.234296   -2.094790    0.572575   \n","2       0.063029   2.173048   -0.910300    0.261152   -2.394719   -1.423128   \n","3       1.673378   1.847214    0.328906   -2.166196   -0.154759   -1.562671   \n","4       0.473823   1.968454   -1.911573   -1.845332   -1.884876    1.018932   \n","...          ...        ...         ...         ...         ...         ...   \n","86862   1.568311   2.311650   -1.313455    0.084025   -2.067061   -1.626081   \n","86863   1.546851   1.650758   -0.986531    0.078107    0.142172   -0.178932   \n","86864  -0.419236   0.746476    0.467034   -0.867942   -2.187681    0.662756   \n","86865  -0.172671   1.497127   -0.829246   -2.438990   -1.361694    0.136683   \n","86866   1.713114  -0.384834   -1.395230   -1.924300   -0.817848   -1.736953   \n","\n","       geo_feat14  geo_feat15  geo_feat16  \n","0        2.200981    1.565647    0.117510  \n","1        0.789134    0.865464   -0.241622  \n","2        2.560501    2.709120    1.935743  \n","3       -0.675002    2.663262    0.962407  \n","4       -0.504536    2.156327    1.971998  \n","...           ...         ...         ...  \n","86862    1.670023   -0.108993    1.685055  \n","86863    1.291193    1.569139    0.641602  \n","86864    1.250141    2.353295    0.393439  \n","86865    0.125450    1.419065    1.316666  \n","86866    2.203258    1.594384    1.684570  \n","\n","[86867 rows x 82 columns]"],"text/html":["\n","  <div id=\"df-5132ab3b-cc1b-4c68-9a0b-9728c896b90a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>count_floors_pre_eq</th>\n","      <th>age</th>\n","      <th>area_percentage</th>\n","      <th>height_percentage</th>\n","      <th>has_superstructure_adobe_mud</th>\n","      <th>has_superstructure_mud_mortar_stone</th>\n","      <th>has_superstructure_stone_flag</th>\n","      <th>has_superstructure_cement_mortar_stone</th>\n","      <th>has_superstructure_mud_mortar_brick</th>\n","      <th>has_superstructure_cement_mortar_brick</th>\n","      <th>has_superstructure_timber</th>\n","      <th>has_superstructure_bamboo</th>\n","      <th>has_superstructure_rc_non_engineered</th>\n","      <th>has_superstructure_rc_engineered</th>\n","      <th>has_superstructure_other</th>\n","      <th>count_families</th>\n","      <th>has_secondary_use</th>\n","      <th>has_secondary_use_agriculture</th>\n","      <th>has_secondary_use_hotel</th>\n","      <th>has_secondary_use_rental</th>\n","      <th>has_secondary_use_institution</th>\n","      <th>has_secondary_use_school</th>\n","      <th>has_secondary_use_industry</th>\n","      <th>has_secondary_use_health_post</th>\n","      <th>has_secondary_use_gov_office</th>\n","      <th>has_secondary_use_use_police</th>\n","      <th>has_secondary_use_other</th>\n","      <th>land_surface_condition_n</th>\n","      <th>land_surface_condition_o</th>\n","      <th>land_surface_condition_t</th>\n","      <th>foundation_type_h</th>\n","      <th>foundation_type_i</th>\n","      <th>foundation_type_r</th>\n","      <th>foundation_type_u</th>\n","      <th>foundation_type_w</th>\n","      <th>roof_type_n</th>\n","      <th>roof_type_q</th>\n","      <th>roof_type_x</th>\n","      <th>ground_floor_type_f</th>\n","      <th>ground_floor_type_m</th>\n","      <th>ground_floor_type_v</th>\n","      <th>ground_floor_type_x</th>\n","      <th>ground_floor_type_z</th>\n","      <th>other_floor_type_j</th>\n","      <th>other_floor_type_q</th>\n","      <th>other_floor_type_s</th>\n","      <th>other_floor_type_x</th>\n","      <th>position_j</th>\n","      <th>position_o</th>\n","      <th>position_s</th>\n","      <th>position_t</th>\n","      <th>plan_configuration_a</th>\n","      <th>plan_configuration_c</th>\n","      <th>plan_configuration_d</th>\n","      <th>plan_configuration_f</th>\n","      <th>plan_configuration_m</th>\n","      <th>plan_configuration_n</th>\n","      <th>plan_configuration_o</th>\n","      <th>plan_configuration_q</th>\n","      <th>plan_configuration_s</th>\n","      <th>plan_configuration_u</th>\n","      <th>legal_ownership_status_a</th>\n","      <th>legal_ownership_status_r</th>\n","      <th>legal_ownership_status_v</th>\n","      <th>legal_ownership_status_w</th>\n","      <th>geo_feat1</th>\n","      <th>geo_feat2</th>\n","      <th>geo_feat3</th>\n","      <th>geo_feat4</th>\n","      <th>geo_feat5</th>\n","      <th>geo_feat6</th>\n","      <th>geo_feat7</th>\n","      <th>geo_feat8</th>\n","      <th>geo_feat9</th>\n","      <th>geo_feat10</th>\n","      <th>geo_feat11</th>\n","      <th>geo_feat12</th>\n","      <th>geo_feat13</th>\n","      <th>geo_feat14</th>\n","      <th>geo_feat15</th>\n","      <th>geo_feat16</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>300051</td>\n","      <td>3</td>\n","      <td>20</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.418456</td>\n","      <td>1.573474</td>\n","      <td>0.290186</td>\n","      <td>1.385418</td>\n","      <td>2.044306</td>\n","      <td>-1.233857</td>\n","      <td>0.814495</td>\n","      <td>1.759849</td>\n","      <td>2.147925</td>\n","      <td>0.117935</td>\n","      <td>0.280309</td>\n","      <td>-2.010242</td>\n","      <td>-1.553949</td>\n","      <td>2.200981</td>\n","      <td>1.565647</td>\n","      <td>0.117510</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>99355</td>\n","      <td>2</td>\n","      <td>25</td>\n","      <td>13</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.455311</td>\n","      <td>1.653826</td>\n","      <td>-0.590032</td>\n","      <td>0.484869</td>\n","      <td>0.953778</td>\n","      <td>-1.714527</td>\n","      <td>-1.081662</td>\n","      <td>1.631580</td>\n","      <td>-0.319924</td>\n","      <td>-1.035920</td>\n","      <td>-1.234296</td>\n","      <td>-2.094790</td>\n","      <td>0.572575</td>\n","      <td>0.789134</td>\n","      <td>0.865464</td>\n","      <td>-0.241622</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>890251</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2.280500</td>\n","      <td>1.703398</td>\n","      <td>0.170643</td>\n","      <td>-1.149626</td>\n","      <td>1.375152</td>\n","      <td>-1.844418</td>\n","      <td>-1.130349</td>\n","      <td>0.063029</td>\n","      <td>2.173048</td>\n","      <td>-0.910300</td>\n","      <td>0.261152</td>\n","      <td>-2.394719</td>\n","      <td>-1.423128</td>\n","      <td>2.560501</td>\n","      <td>2.709120</td>\n","      <td>1.935743</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>745817</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>19</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1.080158</td>\n","      <td>1.392113</td>\n","      <td>0.498317</td>\n","      <td>1.876048</td>\n","      <td>-0.296989</td>\n","      <td>-0.978631</td>\n","      <td>-1.237250</td>\n","      <td>1.673378</td>\n","      <td>1.847214</td>\n","      <td>0.328906</td>\n","      <td>-2.166196</td>\n","      <td>-0.154759</td>\n","      <td>-1.562671</td>\n","      <td>-0.675002</td>\n","      <td>2.663262</td>\n","      <td>0.962407</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>421793</td>\n","      <td>3</td>\n","      <td>15</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2.151010</td>\n","      <td>2.266077</td>\n","      <td>-1.196271</td>\n","      <td>2.337579</td>\n","      <td>1.290038</td>\n","      <td>0.526027</td>\n","      <td>-1.385312</td>\n","      <td>0.473823</td>\n","      <td>1.968454</td>\n","      <td>-1.911573</td>\n","      <td>-1.845332</td>\n","      <td>-1.884876</td>\n","      <td>1.018932</td>\n","      <td>-0.504536</td>\n","      <td>2.156327</td>\n","      <td>1.971998</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>86862</th>\n","      <td>640115</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>16</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1.162097</td>\n","      <td>-0.461051</td>\n","      <td>-1.256883</td>\n","      <td>1.228462</td>\n","      <td>1.243536</td>\n","      <td>-0.264460</td>\n","      <td>-1.804007</td>\n","      <td>1.568311</td>\n","      <td>2.311650</td>\n","      <td>-1.313455</td>\n","      <td>0.084025</td>\n","      <td>-2.067061</td>\n","      <td>-1.626081</td>\n","      <td>1.670023</td>\n","      <td>-0.108993</td>\n","      <td>1.685055</td>\n","    </tr>\n","    <tr>\n","      <th>86863</th>\n","      <td>310028</td>\n","      <td>3</td>\n","      <td>70</td>\n","      <td>20</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>-0.268243</td>\n","      <td>2.145258</td>\n","      <td>-1.216704</td>\n","      <td>1.807258</td>\n","      <td>1.630791</td>\n","      <td>-1.105302</td>\n","      <td>-0.913516</td>\n","      <td>1.546851</td>\n","      <td>1.650758</td>\n","      <td>-0.986531</td>\n","      <td>0.078107</td>\n","      <td>0.142172</td>\n","      <td>-0.178932</td>\n","      <td>1.291193</td>\n","      <td>1.569139</td>\n","      <td>0.641602</td>\n","    </tr>\n","    <tr>\n","      <th>86864</th>\n","      <td>663567</td>\n","      <td>3</td>\n","      <td>25</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1.557673</td>\n","      <td>0.848439</td>\n","      <td>-0.980984</td>\n","      <td>1.096915</td>\n","      <td>1.429782</td>\n","      <td>-1.091510</td>\n","      <td>-0.827044</td>\n","      <td>-0.419236</td>\n","      <td>0.746476</td>\n","      <td>0.467034</td>\n","      <td>-0.867942</td>\n","      <td>-2.187681</td>\n","      <td>0.662756</td>\n","      <td>1.250141</td>\n","      <td>2.353295</td>\n","      <td>0.393439</td>\n","    </tr>\n","    <tr>\n","      <th>86865</th>\n","      <td>1049160</td>\n","      <td>1</td>\n","      <td>50</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2.858545</td>\n","      <td>2.046307</td>\n","      <td>-1.072755</td>\n","      <td>2.094065</td>\n","      <td>-0.597801</td>\n","      <td>-1.782723</td>\n","      <td>0.289512</td>\n","      <td>-0.172671</td>\n","      <td>1.497127</td>\n","      <td>-0.829246</td>\n","      <td>-2.438990</td>\n","      <td>-1.361694</td>\n","      <td>0.136683</td>\n","      <td>0.125450</td>\n","      <td>1.419065</td>\n","      <td>1.316666</td>\n","    </tr>\n","    <tr>\n","      <th>86866</th>\n","      <td>442785</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>9</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.546904</td>\n","      <td>1.652503</td>\n","      <td>-0.546745</td>\n","      <td>0.697128</td>\n","      <td>-0.011629</td>\n","      <td>0.804628</td>\n","      <td>-0.431198</td>\n","      <td>1.713114</td>\n","      <td>-0.384834</td>\n","      <td>-1.395230</td>\n","      <td>-1.924300</td>\n","      <td>-0.817848</td>\n","      <td>-1.736953</td>\n","      <td>2.203258</td>\n","      <td>1.594384</td>\n","      <td>1.684570</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>86867 rows × 82 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5132ab3b-cc1b-4c68-9a0b-9728c896b90a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5132ab3b-cc1b-4c68-9a0b-9728c896b90a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5132ab3b-cc1b-4c68-9a0b-9728c896b90a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["test_data = pd.get_dummies(test_x.copy())\n","test_data = test_data.drop(['geo_level_1_id', 'geo_level_2_id', 'geo_level_3_id'], axis=1)\n","test_data = test_data.assign(geo_feat1=out[:,0],\n","                             geo_feat2=out[:,1],\n","                             geo_feat3=out[:,2],  \n","                             geo_feat4=out[:,3],\n","                             geo_feat5=out[:,4],    \n","                             geo_feat6=out[:,5],\n","                             geo_feat7=out[:,6],\n","                             geo_feat8=out[:,7],\n","                             geo_feat9=out[:,8],\n","                             geo_feat10=out[:,9],\n","                             geo_feat11=out[:,10],\n","                             geo_feat12=out[:,11],\n","                             geo_feat13=out[:,12],\n","                             geo_feat14=out[:,13],\n","                             geo_feat15=out[:,14],           \n","                             geo_feat16=out[:,15])"],"metadata":{"id":"dcAPS4cDsbwx","executionInfo":{"status":"ok","timestamp":1656722675310,"user_tz":180,"elapsed":6,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":60,"outputs":[]},{"cell_type":"code","source":["df = test_data.drop([\"building_id\"], axis=1)\n","x = np.array(df)\n","\n","y_pred = modelxgb_cl.predict(df)"],"metadata":{"id":"JbiDc42EsEn9","executionInfo":{"status":"ok","timestamp":1656722705955,"user_tz":180,"elapsed":2693,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}}},"execution_count":62,"outputs":[]},{"cell_type":"code","source":["y_pred"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ohgfxKLPW9yv","executionInfo":{"status":"ok","timestamp":1656723065267,"user_tz":180,"elapsed":398,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"95bbb0ec-7e0b-4603-88a4-a427c86ad00e"},"execution_count":81,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([3, 2, 3, ..., 2, 3, 3])"]},"metadata":{},"execution_count":81}]},{"cell_type":"code","source":["sub_csv = pd.read_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/data/submission_format.csv\")\n","\n","sub_csv[:-1][\"damage_grade\"] = y_pred\n","sub_csv.to_csv(\"/content/drive/My Drive/Colab Notebooks/Richter's Predictor: Modeling Earthquake Damage/output/submit/xgb_com_feature_engineering.csv\", index=False)"],"metadata":{"id":"rVHw49-zsHQA","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1656723070709,"user_tz":180,"elapsed":519,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"f75be8f7-f2b5-42e5-f862-1b8c792f265f"},"execution_count":82,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  This is separate from the ipykernel package so we can avoid doing imports until\n"]}]},{"cell_type":"code","source":["sub_csv"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"hz04gMK9x7q4","executionInfo":{"status":"ok","timestamp":1656723073691,"user_tz":180,"elapsed":4,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"4de4bbe6-ebab-4313-c2f7-e413390bc666"},"execution_count":83,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       building_id  damage_grade\n","0           300051             3\n","1            99355             2\n","2           890251             3\n","3           745817             2\n","4           421793             2\n","...            ...           ...\n","86863       310028             2\n","86864       663567             2\n","86865      1049160             3\n","86866       442785             3\n","86867       501372             1\n","\n","[86868 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-dd08e0eb-bfce-4aab-9450-f9d8ef5aae67\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>building_id</th>\n","      <th>damage_grade</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>300051</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>99355</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>890251</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>745817</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>421793</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>86863</th>\n","      <td>310028</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>86864</th>\n","      <td>663567</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>86865</th>\n","      <td>1049160</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>86866</th>\n","      <td>442785</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>86867</th>\n","      <td>501372</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>86868 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dd08e0eb-bfce-4aab-9450-f9d8ef5aae67')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dd08e0eb-bfce-4aab-9450-f9d8ef5aae67 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dd08e0eb-bfce-4aab-9450-f9d8ef5aae67');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":83}]},{"cell_type":"code","source":["sub_csv.damage_grade.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5Ih5AUZLW-bo","executionInfo":{"status":"ok","timestamp":1656723075536,"user_tz":180,"elapsed":5,"user":{"displayName":"Antonio Santos","userId":"03265893617080544823"}},"outputId":"e005814a-27ae-4996-d015-419004ef26cf"},"execution_count":84,"outputs":[{"output_type":"execute_result","data":{"text/plain":["2    59706\n","3    23406\n","1     3756\n","Name: damage_grade, dtype: int64"]},"metadata":{},"execution_count":84}]},{"cell_type":"code","source":[""],"metadata":{"id":"Lv29xsH3X4Qt"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"collapsed_sections":["S1SjD-NU1pmB","EzuQlWAIdlLY","G9kigXvVch-X"],"name":"Treinamento - Ensemble Model lgb, cat, xgb.2","provenance":[],"machine_shape":"hm","background_execution":"on","authorship_tag":"ABX9TyPJO0Uz1QRSuZxN92jZa9/Z"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard"},"nbformat":4,"nbformat_minor":0}